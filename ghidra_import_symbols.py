# Ghidra Python Script for AS2464 USB4/NVMe Firmware
# Imports function names, register labels, and global variables from reverse engineering work
#
# To use: Run in Ghidra's Script Manager on the loaded fw.bin
# The script handles both CODE_BANK0 (0x0000-0xFFFF) and CODE_BANK1 (0x10000-0x17FFF)
#
# Memory Layout:
#   CODE_BANK0: 0x0000-0xFFFF  (first 64KB, always accessible)
#   CODE_BANK1: 0x10000-0x17FFF (second bank, mapped to 0x8000-0xFFFF when DPX=1)
#   EXTMEM: 0x0000-0xFFFF (XDATA space - RAM, MMIO registers)
#
# Auto-generated by extract_symbols.py from C source files
#
# @author reverse-asm2464 project
# @category ASMedia.AS2464

from ghidra.program.model.symbol import SourceType
from ghidra.program.model.address import AddressSet

def create_function_if_needed(addr, name):
    """Create function at address if it doesn't exist, then set the name"""
    from ghidra.app.cmd.disassemble import DisassembleCommand
    from ghidra.app.cmd.function import CreateFunctionCmd

    # First, ensure the code is disassembled at this address
    if getInstructionAt(addr) is None:
        disasm_cmd = DisassembleCommand(addr, None, True)
        disasm_cmd.applyTo(currentProgram, monitor)

    # Check if function already exists
    func = getFunctionAt(addr)
    if func is None:
        # Try to create function using CreateFunctionCmd for better analysis
        cmd = CreateFunctionCmd(addr)
        cmd.applyTo(currentProgram, monitor)
        func = getFunctionAt(addr)

    if func is not None:
        func.setName(name, SourceType.USER_DEFINED)
        print("Added function: {} at {}".format(name, addr))
        return True
    else:
        # Fallback: try createFunction API
        try:
            createFunction(addr, name)
            func = getFunctionAt(addr)
            if func is not None:
                print("Added function (fallback): {} at {}".format(name, addr))
                return True
        except:
            pass

        # Last resort: just set a label
        createLabel(addr, name, True)
        print("Added label only: {} at {}".format(name, addr))
        return True

def create_label(addr, name):
    """Create a label at the given address"""
    try:
        createLabel(addr, name, True)
        print("Added label: {} at {}".format(name, addr))
        return True
    except:
        print("Failed to add label: {} at {}".format(name, addr))
        return False

def add_bank0_functions():
    """Add all known Bank 0 function names (0x0000-0xFFFF)"""

    # Bank 0 Function mappings: (address, name)
    # These are verified addresses from our C reimplementation
    functions = [
        (0x0016, "startup_0016"),
        (0x0100, "system_init_from_flash"),
        (0x018b, "buf_start_xfer_mode2"),
        (0x0206, "dispatch_0206"),
        (0x020b, "helper_020b"),
        (0x025a, "buf_set_ctrl_mode_4"),
        (0x026c, "buf_set_ctrl_mode_3"),
        (0x0300, "jump_bank_0"),
        (0x0311, "jump_bank_1"),
        (0x0322, "dispatch_0322"),
        (0x0327, "handler_0327_usb_power_init"),
        (0x0331, "dispatch_0331"),
        (0x0336, "dispatch_0336"),
        (0x033b, "dispatch_033b"),
        (0x0345, "dispatch_0345"),
        (0x034a, "dispatch_034a"),
        (0x034f, "dispatch_034f"),
        (0x0354, "dispatch_0354"),
        (0x0359, "dispatch_0359"),
        (0x035e, "dispatch_035e"),
        (0x0363, "dispatch_0363"),
        (0x0368, "dispatch_0368"),
        (0x036d, "dispatch_036d"),
        (0x0372, "dispatch_0372"),
        (0x0377, "dispatch_0377"),
        (0x037c, "dispatch_037c"),
        (0x0381, "dispatch_0381"),
        (0x0386, "dispatch_0386"),
        (0x038b, "dispatch_038b"),
        (0x0390, "dispatch_0390"),
        (0x0395, "handler_0395"),
        (0x039a, "usb_buffer_dispatch"),
        (0x03a4, "dispatch_03a4"),
        (0x03a9, "dispatch_03a9"),
        (0x03ae, "dispatch_03ae"),
        (0x03b3, "dispatch_03b3"),
        (0x03b8, "dispatch_03b8"),
        (0x03bd, "dispatch_03bd"),
        (0x03c2, "dispatch_03c2"),
        (0x03c7, "dispatch_03c7"),
        (0x03cc, "dispatch_03cc"),
        (0x03d1, "dispatch_03d1"),
        (0x03d6, "dispatch_03d6"),
        (0x03db, "dispatch_03db"),
        (0x03e0, "dispatch_03e0"),
        (0x03e5, "dispatch_03e5"),
        (0x03ea, "dispatch_03ea"),
        (0x03ef, "dispatch_03ef"),
        (0x03f4, "dispatch_03f4"),
        (0x03f9, "dispatch_03f9"),
        (0x03fe, "dispatch_03fe"),
        (0x0403, "dispatch_0403"),
        (0x0408, "dispatch_0408"),
        (0x040d, "dispatch_040d"),
        (0x0412, "dispatch_0412"),
        (0x0417, "helper_0417"),
        (0x041c, "dispatch_041c"),
        (0x0421, "helper_0421"),
        (0x0426, "dispatch_0426"),
        (0x042b, "dispatch_042b"),
        (0x0430, "dispatch_0430"),
        (0x0435, "dispatch_0435"),
        (0x043a, "dispatch_043a"),
        (0x043f, "helper_043f"),
        (0x0444, "dispatch_0444"),
        (0x0449, "dispatch_0449"),
        (0x044e, "dispatch_044e"),
        (0x0453, "dispatch_0453"),
        (0x0458, "protocol_dispatch"),
        (0x045d, "dispatch_045d"),
        (0x0461, "reg_wait_bit_clear"),
        (0x0462, "dispatch_0462"),
        (0x0467, "dispatch_0467"),
        (0x046c, "dispatch_046c"),
        (0x0471, "dispatch_0471"),
        (0x0476, "dispatch_0476"),
        (0x047b, "dispatch_047b"),
        (0x0480, "dispatch_0480"),
        (0x0485, "dispatch_0485"),
        (0x048a, "state_checksum_calc"),
        (0x048f, "dispatch_nop_stub"),
        (0x0494, "event_state_handler"),
        (0x0499, "timer_nvme_completion"),
        (0x049e, "dispatch_049e"),
        (0x04a3, "dispatch_04a3"),
        (0x04a8, "dispatch_04a8"),
        (0x04ad, "dispatch_04ad"),
        (0x04b2, "reserved_stub_handler"),
        (0x04b7, "dispatch_04b7"),
        (0x04bc, "dispatch_04bc"),
        (0x04c1, "dispatch_04c1"),
        (0x04c6, "dispatch_04c6"),
        (0x04cb, "dispatch_04cb"),
        (0x04d0, "timer_link_status_handler"),
        (0x04d5, "dispatch_04d5"),
        (0x04da, "parse_descriptor"),
        (0x04df, "dispatch_04df"),
        (0x04e4, "dispatch_04e4"),
        (0x04e9, "dispatch_04e9"),
        (0x04ee, "dispatch_04ee"),
        (0x04f3, "dispatch_04f3"),
        (0x04f8, "dispatch_04f8"),
        (0x04fd, "dispatch_04fd"),
        (0x0502, "dispatch_0502"),
        (0x0507, "dispatch_0507"),
        (0x050c, "pcie_trigger_trampoline"),
        (0x0511, "timer_config_trampoline"),
        (0x0516, "dispatch_0516"),
        (0x051b, "dispatch_051b"),
        (0x0520, "timer_idle_timeout_handler"),
        (0x0525, "flash_command_handler"),
        (0x052a, "dispatch_052a"),
        (0x052f, "timer_uart_debug_output"),
        (0x0534, "dispatch_0534"),
        (0x0539, "dispatch_0539"),
        (0x053e, "dispatch_helper"),
        (0x0543, "dispatch_0543"),
        (0x0548, "dispatch_0548"),
        (0x054d, "dispatch_054d"),
        (0x0552, "dispatch_0552"),
        (0x0557, "dispatch_handler_0557"),
        (0x055c, "dispatch_055c"),
        (0x0561, "dispatch_0561"),
        (0x0566, "dispatch_0566"),
        (0x056b, "dispatch_056b"),
        (0x0570, "timer_pcie_error_handler"),
        (0x0575, "dispatch_0575"),
        (0x057a, "dispatch_event_e0d9"),
        (0x057f, "dispatch_057f"),
        (0x0584, "dispatch_nop_stub2"),
        (0x0589, "phy_register_config"),
        (0x058e, "dispatch_058e"),
        (0x0593, "timer_pcie_link_event"),
        (0x0598, "dispatch_0598"),
        (0x059d, "dispatch_059d"),
        (0x05a2, "dispatch_05a2"),
        (0x05a7, "dispatch_05a7"),
        (0x05ac, "dispatch_05ac"),
        (0x05b1, "dispatch_05b1"),
        (0x05b6, "dispatch_05b6"),
        (0x05bb, "dispatch_05bb"),
        (0x05c0, "dispatch_05c0"),
        (0x05c5, "dispatch_05c5"),
        (0x05ca, "dispatch_05ca"),
        (0x05cf, "dispatch_05cf"),
        (0x05d4, "dispatch_05d4"),
        (0x05d9, "dispatch_05d9"),
        (0x05de, "dispatch_05de"),
        (0x05e3, "dispatch_05e3"),
        (0x05e8, "dispatch_05e8"),
        (0x05ed, "dispatch_05ed"),
        (0x05f2, "dispatch_05f2"),
        (0x05f7, "pcie_cleanup_05f7"),
        (0x05fc, "pcie_cleanup_05fc"),
        (0x0601, "dispatch_0601"),
        (0x0606, "error_state_config"),
        (0x060b, "dispatch_060b"),
        (0x0610, "dispatch_0610"),
        (0x0615, "dispatch_0615"),
        (0x061a, "timer_pcie_async_event"),
        (0x061f, "dispatch_061f"),
        (0x0624, "dispatch_0624"),
        (0x0633, "pcie_write_reg_0633"),
        (0x0638, "pcie_write_reg_0638"),
        (0x0642, "timer_system_event_stub"),
        (0x0ba9, "banked_store_dword"),
        (0x0bc8, "banked_load_byte"),
        (0x0be6, "banked_store_byte"),
        (0x0bfd, "mul16x16"),
        (0x0c0f, "flash_div8"),
        (0x0c64, "flash_add_to_xdata16"),
        (0x0c7a, "flash_write_word"),
        (0x0c87, "flash_write_idata_word"),
        (0x0c8f, "flash_write_r1_xdata_word"),
        (0x0c9e, "add32"),
        (0x0cab, "sub32"),
        (0x0cb9, "mul32"),
        (0x0d08, "or32"),
        (0x0d15, "xor32"),
        (0x0d22, "cmp32"),
        (0x0d46, "shl32"),
        (0x0d78, "idata_load_dword"),
        (0x0d84, "xdata_load_dword"),
        (0x0d90, "idata_load_dword_alt"),
        (0x0d9d, "xdata_load_dword_alt"),
        (0x0da9, "code_load_dword"),
        (0x0db9, "idata_store_dword"),
        (0x0dc5, "xdata_store_dword"),
        (0x0ddd, "xdata_load_triple"),
        (0x0de6, "xdata_store_triple"),
        (0x0def, "table_search_dispatch_alt"),
        (0x0e15, "table_search_dispatch"),
        (0x0e4f, "pdata_store_dword"),
        (0x0e5b, "ext0_isr"),
        (0x0e78, "int_get_usb_status"),
        (0x0e96, "usb_ep_dispatch_loop"),
        (0x1006, "usb_state_handler_isr_1006"),
        (0x10e0, "usb_master_handler"),
        (0x1196, "nvme_queue_helper"),
        (0x11a2, "scsi_dma_transfer_process"),
        (0x120b, "state_inc_and_calc_120b"),
        (0x120d, "state_transfer_calc_120d"),
        (0x12aa, "state_transfer_setup_12aa"),
        (0x1564, "xdata_write_load_triple_1564"),
        (0x1567, "transfer_helper_1567"),
        (0x156f, "transfer_helper_156f"),
        (0x1571, "transfer_helper_1571"),
        (0x1579, "pcie_txn_index_load"),
        (0x157d, "pcie_txn_array_calc"),
        (0x1586, "state_write_0474_and_calc"),
        (0x159f, "mem_write_via_ptr"),
        (0x15ac, "state_add_offset_0x0e"),
        (0x15af, "state_helper_15af"),
        (0x15c3, "state_read_and_calc_00xx"),
        (0x15dc, "transfer_helper_15dc"),
        (0x15fa, "transfer_helper_15fa"),
        (0x1602, "transfer_func_1602"),
        (0x1607, "write_ff_to_ce40_offset_1607"),
        (0x161a, "transfer_func_161a"),
        (0x1633, "transfer_func_1633"),
        (0x163a, "dma_write_to_scsi_ce96"),
        (0x1646, "get_ep_config_indexed"),
        (0x1659, "ep_config_write_calc"),
        (0x165e, "xdata_read_044e"),
        (0x1660, "xdata_write_0400"),
        (0x1668, "transfer_calc_work43_offset"),
        (0x1677, "dptr_calc_work53_x4"),
        (0x1687, "transfer_get_ep_queue_addr"),
        (0x1696, "transfer_calc_work55_offset"),
        (0x16a2, "transfer_func_16a2"),
        (0x16ae, "dma_write_to_scsi_ce6e"),
        (0x16b0, "transfer_func_16b0"),
        (0x16b7, "transfer_func_16b7"),
        (0x16de, "dma_store_to_0a7d"),
        (0x16e9, "dma_calc_scsi_index"),
        (0x16f3, "dma_clear_status"),
        (0x16ff, "transfer_func_16ff"),
        (0x1709, "dma_set_scsi_param3"),
        (0x1713, "dma_set_scsi_param1"),
        (0x171d, "transfer_func_171d"),
        (0x172c, "transfer_func_172c"),
        (0x173b, "dma_queue_ptr_setup"),
        (0x1743, "usb_get_sys_status_offset"),
        (0x1752, "addr_setup_0059"),
        (0x175d, "dma_init_channel_b8"),
        (0x176b, "usb_calc_queue_addr"),
        (0x1779, "usb_calc_queue_addr_next"),
        (0x1787, "usb_set_done_flag"),
        (0x178e, "usb_set_transfer_flag_1"),
        (0x1795, "dma_clear_state_counters"),
        (0x179d, "usb_calc_indexed_addr"),
        (0x17a9, "dma_init_ep_queue"),
        (0x17b5, "scsi_get_tag_count_status"),
        (0x17c1, "usb_read_queue_status_masked"),
        (0x17cd, "usb_shift_right_3"),
        (0x17d8, "dma_write_idata_to_dptr"),
        (0x17e3, "dma_config_channel_0x10"),
        (0x17e8, "usb_calc_work_area_ptr"),
        (0x17ed, "dma_read_0461"),
        (0x17f3, "dma_shift_rrc2_mask"),
        (0x17f8, "usb_calc_addr_plus_0f"),
        (0x17fd, "dma_calc_addr_002c"),
        (0x1800, "dma_helper_1800"),
        (0x1804, "dma_helper_1804"),
        (0x1808, "usb_calc_addr_04b7_plus"),
        (0x180d, "dma_store_to_0a7d"),
        (0x1818, "usb_get_ep_config_by_status"),
        (0x1819, "dma_process_0a7d_mode1"),
        (0x1828, "usb_get_buf_addr"),
        (0x1838, "usb_get_idata12_high_bits"),
        (0x1848, "usb_check_scsi_ctrl_nonzero"),
        (0x1858, "usb_get_ep_config_txn"),
        (0x1868, "usb_check_idata_16_17_nonzero"),
        (0x1878, "usb_reset_interface_full"),
        (0x1900, "usb_calc_buf_offset"),
        (0x1910, "usb_calc_dma_work_offset"),
        (0x1920, "usb_set_dma_mode_params"),
        (0x1930, "usb_load_pcie_txn_count"),
        (0x1940, "usb_subtract_from_idata16"),
        (0x1950, "usb_get_nvme_cmd_type"),
        (0x1960, "usb_core_protocol_dispatch"),
        (0x1970, "usb_inc_param_counter"),
        (0x1980, "usb_copy_idata_16_to_xdata"),
        (0x1990, "usb_clear_nvme_status_bit1"),
        (0x19a0, "usb_add_nvme_param_20"),
        (0x19b0, "usb_lookup_xdata_via_code"),
        (0x19c0, "usb_set_reg_bit7"),
        (0x19d0, "usb_store_idata_16_17"),
        (0x19e0, "usb_add_index_counter"),
        (0x19f0, "usb_check_signature"),
        (0x1a00, "usb_xfer_ctrl_init"),
        (0x1aad, "queue_param_buf_calc"),
        (0x1af9, "usb_dec_indexed_counter"),
        (0x1b05, "usb_store_indexed_config_0171"),
        (0x1b07, "nvme_func_1b07"),
        (0x1b0b, "xdata_read_0100"),
        (0x1b14, "usb_xdata_copy_with_offset"),
        (0x1b20, "usb_func_1b20"),
        (0x1b23, "usb_func_1b23"),
        (0x1b2b, "nvme_check_threshold_r5"),
        (0x1b2e, "usb_calc_addr_01xx"),
        (0x1b30, "usb_calc_addr_012b_plus"),
        (0x1b38, "nvme_check_threshold_0x3e"),
        (0x1b47, "nvme_status_update"),
        (0x1b4d, "usb_check_status"),
        (0x1b55, "write_and_set_c412_bit1_1b55"),
        (0x1b58, "usb_configure"),
        (0x1b59, "set_c412_bit1_1b59"),
        (0x1b60, "usb_marshal_idata_to_xdata"),
        (0x1b77, "core_state_read16"),
        (0x1b7e, "usb_enable"),
        (0x1b84, "nvme_get_idata_009f"),
        (0x1b86, "usb_copy_idata_6b_to_6f"),
        (0x1b88, "usb_calc_ep_status_addr"),
        (0x1b96, "usb_get_ep_config_indexed"),
        (0x1ba5, "buf_addr_read16"),
        (0x1bae, "usb_get_idata_0x12_field"),
        (0x1bc1, "usb_write_ep_config"),
        (0x1bc3, "usb_reset_interface"),
        (0x1bcb, "usb_copy_idata_6b_to_6f"),
        (0x1bd5, "usb_setup_endpoint"),
        (0x1bd7, "mem_read_ptr_1bd7"),
        (0x1bde, "usb_set_ep0_mode_bit"),
        (0x1be1, "set_usb_status_bit0_1be1"),
        (0x1be8, "usb_get_config_90e0"),
        (0x1bf1, "usb_check_ep_status_flags"),
        (0x1bf6, "usb_calc_buf_offset"),
        (0x1c00, "usb_store_buf_offset"),
        (0x1c01, "usb_clear_mode_bit"),
        (0x1c0b, "usb_set_ep0_len"),
        (0x1c0f, "nvme_initialize"),
        (0x1c1b, "usb_set_buffer_mode"),
        (0x1c22, "usb_check_scsi_ctrl_nonzero"),
        (0x1c2a, "usb_lookup_code_table_5cad"),
        (0x1c31, "usb_ep_data_transfer"),
        (0x1c3a, "usb_calc_dma_work_offset"),
        (0x1c43, "nvme_func_1c43"),
        (0x1c46, "usb_update_status_regs"),
        (0x1c4a, "usb_set_dma_mode_params"),
        (0x1c55, "usb_get_nvme_dev_status_masked"),
        (0x1c56, "nvme_dev_status_hi"),
        (0x1c5b, "usb_get_config_masked"),
        (0x1c5d, "pcie_txn_table_lookup"),
        (0x1c6d, "core_state_sub16"),
        (0x1c71, "usb_check_transfer_complete"),
        (0x1c77, "nvme_cmd_param_hi"),
        (0x1c7e, "nvme_func_1c7e"),
        (0x1c86, "usb_reset_endpoint"),
        (0x1c88, "nvme_calc_idata_offset"),
        (0x1c90, "usb_get_ep_config_txn"),
        (0x1c9f, "usb_core_protocol_dispatch"),
        (0x1ca5, "usb_check_idata_16_17_nonzero"),
        (0x1cae, "queue_index_inc_wrap"),
        (0x1cb7, "nvme_get_cmd_param_upper"),
        (0x1cc1, "ep_queue_ctrl_set_84"),
        (0x1cc8, "usb_copy_idata_16_to_xdata"),
        (0x1cd4, "usb_clear_nvme_status_bit1"),
        (0x1cdc, "usb_add_nvme_param_20"),
        (0x1ce4, "dptr_calc_04b7_work23"),
        (0x1cf0, "usb_setup_transfer_mode5"),
        (0x1cfc, "usb_ep_config_bulk"),
        (0x1d07, "usb_ep_config_int"),
        (0x1d12, "usb_lookup_xdata_via_code"),
        (0x1d1d, "usb_set_transfer_flag"),
        (0x1d24, "usb_get_nvme_data_ctrl"),
        (0x1d2b, "usb_set_nvme_ctrl_bit7"),
        (0x1d32, "usb_store_idata_16"),
        (0x1d39, "usb_index_add_wrap"),
        (0x1d43, "tlp_status_clear"),
        (0x23f7, "dma_transfer_state_dispatch"),
        (0x2608, "dma_interrupt_handler"),
        (0x2bea, "state_action_dispatch"),
        (0x2db7, "scsi_dma_transfer_state"),
        (0x2f67, "scsi_dma_queue_setup"),
        (0x2f80, "main_loop"),
        (0x3023, "power_get_status_bit6"),
        (0x302f, "phy_check_usb_state"),
        (0x3031, "phy_check_usb_state"),
        (0x3094, "timer1_check_and_ack"),
        (0x312a, "usb_set_transfer_active_flag"),
        (0x3130, "helper_3130"),
        (0x313a, "helper_313a_check_nonzero"),
        (0x313d, "buf_check_transfer_pending"),
        (0x313f, "helper_313f"),
        (0x3147, "usb_copy_status_to_buffer"),
        (0x3168, "helper_3168"),
        (0x3181, "usb_read_status_pair"),
        (0x31a0, "nvme_process_cmd"),
        (0x31a5, "usb_read_transfer_params"),
        (0x31ad, "helper_31ad"),
        (0x31ce, "usb_set_status_bit7"),
        (0x31d5, "usb_calc_dptr_0108"),
        (0x31da, "nvme_build_cmd"),
        (0x31e0, "usb_calc_dptr_with_0c"),
        (0x31ea, "nvme_get_ep_table_entry"),
        (0x31fb, "usb_validate_descriptor"),
        (0x3200, "usb_dma_transfer_setup"),
        (0x320c, "nvme_set_ep_ctrl_bits"),
        (0x3212, "nvme_set_usb_ep_ctrl_bit2"),
        (0x3219, "nvme_call_and_signal"),
        (0x3223, "nvme_calc_dptr_0100_base"),
        (0x322e, "helper_322e"),
        (0x323b, "nvme_set_buffer_flags"),
        (0x3244, "nvme_check_completion"),
        (0x3247, "nvme_ring_doorbell"),
        (0x3249, "nvme_initialize"),
        (0x3257, "nvme_set_ep_ctrl_bits"),
        (0x325f, "nvme_set_usb_ep_ctrl_bit2"),
        (0x3267, "nvme_init_step"),
        (0x3272, "nvme_read_status"),
        (0x3279, "helper_3279"),
        (0x3280, "nvme_set_int_aux_bit1"),
        (0x328a, "nvme_get_link_status_masked"),
        (0x3291, "nvme_get_idata_0d_r7"),
        (0x3298, "nvme_get_dma_status_masked"),
        (0x329f, "nvme_wait_for_ready"),
        (0x32a4, "nvme_io_handler"),
        (0x32a5, "protocol_state_dispatcher_32a5"),
        (0x3300, "usb_scsi_dma_check_init"),
        (0x3400, "usb_set_status_9093"),
        (0x3410, "usb_read_flash_status_bits"),
        (0x3419, "nvme_init_registers"),
        (0x3420, "usb_set_xfer_mode_check_ctrl"),
        (0x36ab, "helper_36ab"),
        (0x38d4, "helper_38d4"),
        (0x3900, "protocol_state_machine"),
        (0x39e4, "protocol_init"),
        (0x3adb, "nvme_completion_handler"),
        (0x3bcd, "helper_3bcd"),
        (0x3cb8, "helper_3cb8"),
        (0x3e81, "nvme_queue_process_pending"),
        (0x3f4a, "helper_3f4a"),
        (0x4013, "scsi_setup_transfer_result"),
        (0x4042, "scsi_process_transfer"),
        (0x40d9, "scsi_state_dispatch"),
        (0x419d, "scsi_setup_action"),
        (0x425f, "scsi_init_transfer_mode"),
        (0x431a, "main"),
        (0x4352, "process_init_table"),
        (0x43d3, "scsi_dma_dispatch"),
        (0x4469, "scsi_dma_start_with_param"),
        (0x4486, "ext1_isr"),
        (0x44a3, "int_get_system_status"),
        (0x44a7, "int_check_system_event"),
        (0x44ba, "int_get_pcie_nvme_status"),
        (0x44be, "int_check_nvme_queue"),
        (0x44d0, "int_check_pcie_event"),
        (0x44da, "int_check_nvme_complete"),
        (0x4511, "int_check_timer"),
        (0x4532, "scsi_command_dispatch"),
        (0x45d0, "scsi_buffer_threshold_config"),
        (0x466b, "scsi_transfer_dispatch"),
        (0x46f8, "scsi_setup_action"),
        (0x4784, "nvme_state_handler"),
        (0x480c, "scsi_nvme_queue_process"),
        (0x488f, "nvme_process_queue_entries"),
        (0x4900, "nvme_io_request"),
        (0x4904, "scsi_csw_build"),
        (0x4977, "scsi_csw_send"),
        (0x49e9, "nvme_queue_sync"),
        (0x4a00, "nvme_build_cmd"),
        (0x4a57, "dma_config_channel"),
        (0x4a94, "dma_start_transfer"),
        (0x4abf, "scsi_dma_dispatch_helper"),
        (0x4b00, "nvme_get_ep_table_entry"),
        (0x4b25, "scsi_dma_dispatch"),
        (0x4b60, "nvme_submit_cmd"),
        (0x4b8b, "scsi_endpoint_queue_process"),
        (0x4be6, "init_sys_flags_07f0"),
        (0x4c00, "nvme_io_handler"),
        (0x4c40, "scsi_dma_set_mode"),
        (0x4c98, "scsi_dma_check_mask"),
        (0x4d44, "scsi_state_handler"),
        (0x4d92, "scsi_handle_init_4d92"),
        (0x4ddc, "scsi_transfer_check"),
        (0x4e25, "scsi_buffer_setup_4e25"),
        (0x4e6d, "helper_4e6d"),
        (0x4ef5, "scsi_queue_scan_handler"),
        (0x4f37, "nvme_scsi_cmd_buffer_setup"),
        (0x4f77, "scsi_transfer_helper_4f77"),
        (0x4fb6, "main_polling_handler"),
        (0x4fdb, "phy_poll_link_ready"),
        (0x4ff2, "scsi_command_dispatch"),
        (0x5008, "scsi_core_process"),
        (0x502e, "scsi_clear_slot_entry"),
        (0x5038, "addr_calc_high_borrow"),
        (0x5043, "buf_read_offset_08"),
        (0x5046, "buf_read_base"),
        (0x504f, "queue_buf_addr_high"),
        (0x5058, "scsi_addr_adjust_5058"),
        (0x505d, "buf_read_offset_3e"),
        (0x5061, "scsi_xdata_read_5061"),
        (0x5069, "scsi_transfer_start"),
        (0x50a2, "scsi_transfer_start_alt"),
        (0x50ff, "scsi_tag_setup_50ff"),
        (0x5112, "scsi_cbw_parse"),
        (0x519e, "scsi_read_ctrl_indexed"),
        (0x51c7, "uart_puthex"),
        (0x51e6, "uart_putdigit"),
        (0x51ef, "usb_helper_51ef"),
        (0x51f9, "scsi_usbc_signature_check_51f9"),
        (0x5200, "usb_check_signature"),
        (0x5216, "scsi_read_slot_table"),
        (0x523c, "usb_dma_transfer_setup"),
        (0x5256, "buf_start_xfer_mode1"),
        (0x5260, "usb_scsi_dma_check_init"),
        (0x5284, "phy_config_link_params"),
        (0x52a7, "usb_ep_process"),
        (0x52b1, "scsi_state_dispatch_52b1"),
        (0x52c7, "scsi_queue_dispatch"),
        (0x52e0, "usb_write_ep_config"),
        (0x5300, "usb_set_status_9093"),
        (0x5305, "scsi_flash_ready_check"),
        (0x530b, "usb_read_flash_status_bits"),
        (0x5321, "usb_write_ep_ctrl_by_mode"),
        (0x533d, "usb_set_xfer_mode_check_ctrl"),
        (0x5359, "usb_get_indexed_status"),
        (0x5373, "scsi_dma_check_mask"),
        (0x538d, "uart_puts"),
        (0x5398, "uart_putc"),
        (0x53a0, "usb_ep_queue_process"),
        (0x53a7, "scsi_decrement_pending"),
        (0x53c0, "buf_write_idata_params"),
        (0x53d4, "usb_clear_idata_6f_72"),
        (0x53e6, "usb_copy_idata_16_to_ptr"),
        (0x5400, "usb_set_transfer_active_flags"),
        (0x5409, "usb_clear_state_and_dispatch"),
        (0x5418, "reg_set_bit_0"),
        (0x541f, "usb_get_e716_status"),
        (0x5426, "usb_wait_with_timeout"),
        (0x5442, "usb_endpoint_handler"),
        (0x544c, "usb_setup_transfer_mode5_24"),
        (0x5455, "usb_buffer_config_status"),
        (0x545c, "usb_clear_power_init_flag"),
        (0x5462, "usb_init_transfer_mode5"),
        (0x573b, "scsi_loop_process_573b"),
        (0x5cad, "usb_lookup_code_table_5cad"),
        (0x9264, "nvme_queue_count_matches_9264"),
        (0x92b3, "nvme_queue_status_read"),
        (0x92bb, "nvme_state_error_set_92bb"),
        (0x9388, "flash_config_init_9388"),
        (0x955d, "cmd_write_cc89_01"),
        (0x955e, "nvme_cmd_store_direct"),
        (0x9566, "cmd_calc_slot_addr"),
        (0x957b, "nvme_cmd_store_and_read"),
        (0x9580, "nvme_cmd_read_offset"),
        (0x9584, "cmd_config_e40b"),
        (0x95a0, "cmd_call_e120_setup"),
        (0x95a2, "nvme_cmd_issue_alternate"),
        (0x95a5, "nvme_cmd_issue_simple"),
        (0x95a8, "cmd_issue_tag_and_wait"),
        (0x95ab, "nvme_cmd_store_pair_trigger"),
        (0x95af, "nvme_cmd_set_state_6"),
        (0x95b6, "cmd_clear_cc9a_setup"),
        (0x95bf, "nvme_timer_ack_95bf"),
        (0x95c2, "timer0_csr_ack"),
        (0x95c5, "nvme_timer_ack_ptr"),
        (0x95c9, "cmd_calc_dptr_offset"),
        (0x95da, "nvme_cmd_store_pair_trigger"),
        (0x95e1, "helper_95e1"),
        (0x95eb, "cmd_extract_bit5"),
        (0x95f9, "cmd_clear_5_bytes"),
        (0x9605, "cmd_start_trigger"),
        (0x9608, "nvme_cmd_set_bit1_ptr"),
        (0x960f, "cmd_write_issue_bits"),
        (0x9617, "cmd_set_c801_bit4"),
        (0x9621, "cmd_clear_cc88_cc8a"),
        (0x9627, "nvme_cmd_store_clear_cc8a"),
        (0x962e, "cmd_check_op_counter"),
        (0x9635, "cmd_config_e405_e421"),
        (0x9647, "cmd_clear_bits"),
        (0x964f, "cmd_write_cc89_02"),
        (0x9656, "cmd_extract_bits67"),
        (0x9657, "nvme_cmd_shift_2_mask3"),
        (0x965d, "cmd_set_op_counter"),
        (0x9664, "cmd_setup_delay"),
        (0x966b, "cmd_read_indexed"),
        (0x9675, "cmd_combine_lba_param"),
        (0x9677, "nvme_lba_combine"),
        (0x9684, "cmd_set_op_counter_1"),
        (0x9687, "nvme_set_ptr_1"),
        (0x968c, "nvme_nop_968c"),
        (0x968f, "cmd_combine_lba_alt"),
        (0x969d, "cmd_wait_and_store_counter"),
        (0x96a6, "cmd_set_dptr_inc2"),
        (0x96a7, "nvme_nop_96a7"),
        (0x96a9, "nvme_nop_96a9"),
        (0x96ae, "cmd_call_e73a_with_params"),
        (0x96b7, "cmd_read_dptr_offset1"),
        (0x96b8, "nvme_read_offset_1"),
        (0x96bf, "cmd_update_slot_index"),
        (0x96cd, "cmd_set_flag_07de"),
        (0x96d4, "cmd_store_addr_hi"),
        (0x96d6, "nvme_cmd_calc_store_3"),
        (0x96d7, "nvme_cmd_calc_store_2"),
        (0x96e1, "cmd_load_addr"),
        (0x96ee, "cmd_read_state_shift"),
        (0x96f7, "cmd_clear_trigger_bits"),
        (0x9703, "cmd_write_trigger_wait"),
        (0x9713, "cmd_config_e400_e420"),
        (0x971e, "cmd_setup_e424_e425"),
        (0x9729, "cmd_set_trigger_bit6"),
        (0x9730, "cmd_call_dd12_config"),
        (0x973a, "cmd_extract_bits67_write"),
        (0x9741, "cfg_clear_ep_regs"),
        (0x9902, "pcie_init"),
        (0x990c, "pcie_init_alt"),
        (0x9916, "pcie_store_txn_idx"),
        (0x9923, "pcie_init_idata_65_63"),
        (0x9930, "pcie_setup_buffer_from_config"),
        (0x994c, "pcie_write_data_reg_with_val"),
        (0x994e, "pcie_write_data_reg"),
        (0x9954, "pcie_calc_queue_idx"),
        (0x995a, "pcie_get_txn_count_with_mult"),
        (0x9962, "pcie_get_txn_count_hi"),
        (0x996a, "pcie_check_txn_count"),
        (0x9977, "pcie_check_txn_count"),
        (0x9980, "pcie_store_to_05b8"),
        (0x998a, "pcie_store_r6_to_05a6"),
        (0x9996, "pcie_wait_for_completion"),
        (0x999d, "pcie_clear_and_trigger"),
        (0x99af, "pcie_read_and_store_idata"),
        (0x99bc, "pcie_store_r7_to_05b7"),
        (0x99c6, "pcie_set_0a5b_flag"),
        (0x99c7, "cfg_set_ep_flag_1"),
        (0x99ce, "cfg_inc_ep_flag"),
        (0x99d1, "cfg_inc_reg_value"),
        (0x99d5, "pcie_lookup_and_store_idata"),
        (0x99d8, "cfg_store_ep_config"),
        (0x99e0, "pcie_write_config_and_trigger"),
        (0x99e1, "cfg_set_b480_bit0"),
        (0x99eb, "cfg_get_b296_bit2"),
        (0x99f6, "cfg_init_ep_mode"),
        (0x9a00, "cfg_store_ep_with_carry"),
        (0x9a09, "pcie_check_status_complete"),
        (0x9a10, "pcie_check_status_error"),
        (0x9a18, "cfg_write_dptr_34_04"),
        (0x9a30, "cfg_write_b217"),
        (0x9a33, "pcie_write_tlp_addr_low"),
        (0x9a3b, "pcie_set_byte_enables_0f"),
        (0x9a46, "pcie_setup_buffer_params_ext"),
        (0x9a53, "pcie_clear_reg_at_offset"),
        (0x9a60, "pcie_get_link_speed"),
        (0x9a6c, "pcie_get_link_speed_masked"),
        (0x9a74, "pcie_read_completion_data"),
        (0x9a8a, "pcie_inc_txn_counters"),
        (0x9a95, "pcie_write_status_complete"),
        (0x9a9c, "pcie_clear_address_regs"),
        (0x9aa3, "pcie_clear_address_regs_full"),
        (0x9aa9, "pcie_get_txn_count_hi"),
        (0x9ab3, "pcie_inc_txn_count"),
        (0x9aba, "pcie_write_data_reg_with_val"),
        (0x9ad0, "pcie_write_data_reg"),
        (0x9af0, "pcie_calc_queue_idx"),
        (0x9b00, "pcie_store_to_05b8"),
        (0x9b10, "pcie_read_and_store_idata"),
        (0x9b20, "pcie_store_r7_to_05b7"),
        (0x9b30, "pcie_set_0a5b_flag"),
        (0x9b31, "cmd_setup_with_params"),
        (0x9b40, "pcie_inc_0a5b"),
        (0x9b50, "pcie_lookup_and_store_idata"),
        (0x9b60, "pcie_write_config_and_trigger"),
        (0x9b70, "pcie_get_status_bit2"),
        (0x9b80, "pcie_add_2_to_idata"),
        (0xa2c2, "pcie_link_config_a2c2"),
        (0xa2df, "pcie_set_state_a2df"),
        (0xa2eb, "pcie_lane_write_cc_a2eb"),
        (0xa2ff, "pcie_read_link_state"),
        (0xa308, "pcie_setup_lane_a308"),
        (0xa310, "pcie_setup_lane_a310"),
        (0xa31c, "pcie_lane_setup_a31c"),
        (0xa334, "pcie_read_status_a334"),
        (0xa33d, "pcie_read_ext_reg"),
        (0xa344, "pcie_setup_all_lanes_a344"),
        (0xa348, "pcie_get_status_a348"),
        (0xa34f, "pcie_get_status_a34f"),
        (0xa358, "pcie_modify_and_read_a358"),
        (0xa35f, "pcie_modify_and_read_a35f"),
        (0xa365, "pcie_write_66_a365"),
        (0xa372, "pcie_get_status_a372"),
        (0xa374, "pcie_check_int_source_a374"),
        (0xa37b, "pcie_store_status_a37b"),
        (0xa38b, "pcie_setup_a38b"),
        (0xa3c4, "pcie_check_int_source_a3c4"),
        (0xa3db, "pcie_reg_set_bit4_a3db"),
        (0xa3f5, "pcie_config_init_a3f5"),
        (0xa522, "pcie_interrupt_handler"),
        (0xa53a, "pcie_interrupt_handler"),
        (0xa62d, "nvme_queue_get_e710_masked"),
        (0xa637, "usb_descriptor_helper_a637"),
        (0xa639, "nvme_queue_set_0ad7"),
        (0xa63c, "nvme_queue_store_clear_0ade"),
        (0xa63d, "nvme_queue_clear_0ade"),
        (0xa644, "usb_descriptor_helper_a644"),
        (0xa648, "usb_descriptor_helper_a648"),
        (0xa651, "usb_descriptor_helper_a651"),
        (0xa655, "usb_descriptor_helper_a655"),
        (0xa660, "nvme_queue_init_9100"),
        (0xa666, "nvme_queue_get_9100"),
        (0xa66d, "nvme_queue_and_acb_af2"),
        (0xa679, "nvme_queue_clear_usb_bit0"),
        (0xa687, "nvme_queue_set_usb_config"),
        (0xa692, "nvme_queue_set_9092"),
        (0xa69a, "nvme_queue_init_9e16"),
        (0xa6ad, "nvme_queue_init_905x"),
        (0xa6c6, "nvme_queue_config_9006"),
        (0xa6dc, "nvme_queue_calc_0ae0_0ae1"),
        (0xa6ef, "nvme_queue_get_e302_shift"),
        (0xa6f6, "nvme_queue_shift_param"),
        (0xa6fd, "nvme_queue_mask_0acf"),
        (0xa704, "helper_a704"),
        (0xa71b, "nvme_queue_clear_9003"),
        (0xa72b, "nvme_queue_set_bit0_ptr"),
        (0xa732, "nvme_queue_get_9090_mask"),
        (0xa739, "nvme_queue_set_90e3_2"),
        (0xa9f9, "power_state_return_05"),
        (0xaa02, "power_state_helper_aa02"),
        (0xaa09, "queue_helper_aa09"),
        (0xaa10, "queue_index_return_05"),
        (0xaa13, "power_state_helper_aa13"),
        (0xaa1d, "power_state_helper_aa1d"),
        (0xaa26, "power_state_helper_aa26"),
        (0xaa2a, "nvme_admin_check_param"),
        (0xaa2b, "queue_helper_aa2b"),
        (0xaa30, "nvme_admin_nop_aa30"),
        (0xaa33, "nvme_admin_nop_aa33"),
        (0xaa36, "nvme_cmd_state_handler"),
        (0xaa37, "cmd_setup_aa37"),
        (0xaa42, "queue_helper_aa42"),
        (0xaa4e, "queue_helper_aa4e"),
        (0xaa57, "queue_helper_aa57"),
        (0xaa71, "queue_helper_aa71"),
        (0xaa7d, "queue_helper_aa7d"),
        (0xaa7f, "queue_helper_aa7f"),
        (0xaa90, "queue_helper_aa90"),
        (0xaaab, "queue_helper_aaab"),
        (0xaaad, "queue_helper_aaad"),
        (0xaab5, "queue_helper_aab5"),
        (0xaafb, "nvme_admin_set_state_07c4"),
        (0xab0d, "nvme_admin_call_dd0e_95a0"),
        (0xab27, "queue_dispatch_ab27"),
        (0xab3a, "queue_dispatch_ab3a"),
        (0xabc9, "queue_setup_abc9"),
        (0xabd4, "nvme_admin_abd4"),
        (0xabd7, "nvme_admin_abd7"),
        (0xabe9, "nvme_admin_abe9"),
        (0xad95, "timer0_wait_done"),
        (0xadb0, "delay_loop_adb0"),
        (0xadc3, "pcie_setup_config_tlp"),
        (0xb104, "pcie_tlp_handler_b104"),
        (0xb1a4, "flash_wait_and_poll"),
        (0xb28c, "pcie_tlp_handler_b28c"),
        (0xb402, "pcie_tlp_handler_b402"),
        (0xb624, "nvme_cmd_setup_b624"),
        (0xb640, "cmd_setup_read_write"),
        (0xb6cf, "nvme_cmd_setup_b6cf"),
        (0xb6d4, "buffer_helper_b6d4"),
        (0xb6f0, "buffer_helper_b6f0"),
        (0xb6fa, "buffer_helper_b6fa"),
        (0xb779, "nvme_cmd_setup_b779"),
        (0xb820, "nvme_pcie_init_b820"),
        (0xb825, "nvme_pcie_init_b825"),
        (0xb833, "nvme_pcie_init_b833"),
        (0xb838, "nvme_pcie_init_b838"),
        (0xb845, "flash_set_cmd"),
        (0xb848, "nvme_pcie_get_b848"),
        (0xb850, "nvme_pcie_store_b850"),
        (0xb851, "nvme_pcie_store_b851"),
        (0xb85b, "flash_set_mode_bit4"),
        (0xb865, "flash_set_addr_md"),
        (0xb873, "flash_set_addr_hi"),
        (0xb881, "nvme_queue_submit"),
        (0xb888, "flash_set_data_len"),
        (0xb895, "flash_read_buffer_and_status"),
        (0xb8a2, "flash_write_enable"),
        (0xb8ae, "flash_set_mode_enable"),
        (0xb8b9, "nvme_pcie_handler_b8b9"),
        (0xba06, "nvme_completion_poll"),
        (0xbb37, "reg_clear_bits_and_init"),
        (0xbb4f, "reg_read_indexed_0a84"),
        (0xbb5e, "reg_extract_bit6"),
        (0xbb68, "reg_set_bits_1_2"),
        (0xbb75, "reg_extract_bit7"),
        (0xbb7e, "reg_clear_bit3_link_ctrl"),
        (0xbb8f, "reg_write_indexed"),
        (0xbb96, "reg_extract_bits_6_7"),
        (0xbba0, "reg_extract_bit0"),
        (0xbba8, "reg_set_bit6"),
        (0xbbaf, "reg_set_bit1"),
        (0xbbb6, "power_set_event_ctrl"),
        (0xbbc0, "reg_set_bit3"),
        (0xbbc7, "sys_init_helper_bbc7"),
        (0xbc57, "ext_mem_read_stub"),
        (0xbc70, "reg_nibble_swap_store"),
        (0xbc88, "reg_read_bank_1235"),
        (0xbc8f, "reg_read_bank_0200"),
        (0xbc98, "reg_read_bank_1200"),
        (0xbc9f, "queue_status_bc9f"),
        (0xbca5, "reg_read_and_clear_bit3"),
        (0xbcaf, "reg_read_bank_1603"),
        (0xbcb8, "reg_nibble_extract"),
        (0xbcc4, "reg_read_bank_1504_clear"),
        (0xbcd0, "reg_read_bank_1200_alt"),
        (0xbcd7, "reg_read_event_mask"),
        (0xbcde, "reg_read_bank_1407"),
        (0xbce7, "reg_write_and_set_link_bit0"),
        (0xbcf2, "reg_timer_setup_and_set_bits"),
        (0xbcfe, "cmd_queue_handler"),
        (0xbd05, "reg_timer_init_and_start"),
        (0xbd14, "reg_timer_clear_bits"),
        (0xbd23, "reg_set_bit5"),
        (0xbd2a, "reg_clear_bits_5_6"),
        (0xbd33, "reg_read_cc3e_clear_bit1"),
        (0xbd3a, "reg_set_bit6_generic"),
        (0xbd41, "reg_clear_bit1_cc3b"),
        (0xbd49, "reg_read_link_width"),
        (0xbd50, "reg_read_link_status_e716"),
        (0xbd57, "reg_read_cpu_mode_next"),
        (0xbd5e, "reg_set_bit2"),
        (0xbd65, "reg_set_bit7"),
        (0xbe36, "flash_run_transaction"),
        (0xbe6a, "flash_start_transaction"),
        (0xbe70, "flash_poll_busy"),
        (0xbe77, "flash_clear_mode_bits"),
        (0xbe82, "flash_clear_mode_bits_6_7"),
        (0xbe8b, "reg_read_phy_mode_lane_config"),
        (0xbefb, "reg_delay_param_setup"),
        (0xbf04, "reg_read_phy_lanes"),
        (0xbf8e, "reg_clear_state_flags"),
        (0xbf9a, "buffer_state_handler"),
        (0xbfb8, "transfer_state_handler"),
        (0xbfc4, "system_state_clear_bfc4"),
        (0xc00d, "pcie_tunnel_enable"),
        (0xc105, "pcie_event_handler"),
        (0xc1f9, "pcie_tlp_init_and_transfer"),
        (0xc20c, "pcie_setup_memory_tlp"),
        (0xc245, "pcie_poll_and_read_completion"),
        (0xc2f4, "error_log_process"),
        (0xc48f, "error_log_set_status"),
        (0xc496, "error_log_get_array_ptr_2"),
        (0xc8db, "pcie_adapter_config"),
        (0xc9ef, "power_reset_sys_state_c9ef"),
        (0xc9fa, "power_check_event_ctrl_c9fa"),
        (0xca0d, "power_state_handler"),
        (0xcad6, "power_set_suspended_and_event_cad6"),
        (0xcaed, "power_toggle_usb_bit2_caed"),
        (0xcafb, "power_set_phy_bit1_cafb"),
        (0xcb05, "phy_set_config_bit0"),
        (0xcb09, "power_clear_init_flag"),
        (0xcb0f, "power_get_state_nibble_cb0f"),
        (0xcb15, "power_set_event_ctrl"),
        (0xcb19, "power_set_link_status_cb19"),
        (0xcb23, "power_set_suspended"),
        (0xcb2d, "power_clear_suspended"),
        (0xcb37, "power_config_init"),
        (0xcb4b, "power_set_clock_bit1"),
        (0xcb54, "phy_init_sequence"),
        (0xcb6f, "power_enable_clocks"),
        (0xcb88, "power_disable_clocks"),
        (0xcb98, "phy_register_config"),
        (0xcd66, "pcie_tunnel_setup"),
        (0xcd6c, "pcie_tunnel_setup"),
        (0xce23, "dma_transfer_handler"),
        (0xceab, "dma_poll_complete"),
        (0xd02a, "power_state_machine_d02a"),
        (0xd07f, "usb_mode_config_d07f"),
        (0xd17a, "helper_d17a"),
        (0xd436, "pcie_lane_config"),
        (0xd5da, "pcie_check_and_trigger_d5da"),
        (0xd630, "power_config_d630"),
        (0xd676, "handler_d676"),
        (0xd702, "phy_link_training"),
        (0xd810, "usb_buffer_handler"),
        (0xd852, "usb_buffer_dispatch"),
        (0xd8d5, "pcie_handler_d8d5"),
        (0xd916, "phy_power_init_d916"),
        (0xd996, "transfer_continuation_d996"),
        (0xda9f, "usb_check_phy_status"),
        (0xdace, "uart_read_byte_dace"),
        (0xdaeb, "uart_write_byte_daeb"),
        (0xdaff, "uart_write_daff"),
        (0xdb10, "uart_wait_tx_ready"),
        (0xdb2f, "pcie_lane_config_helper"),
        (0xdd0e, "cmd_trigger_default"),
        (0xdd12, "cmd_trigger_params"),
        (0xdd42, "helper_dd42"),
        (0xdde2, "power_check_state_dde2"),
        (0xe03c, "check_nvme_ready_e03c"),
        (0xe09a, "cmd_check_busy"),
        (0xe120, "cmd_param_setup"),
        (0xe1c6, "cmd_wait_completion"),
        (0xe214, "nvme_queue_config_e214"),
        (0xe25e, "state_update_e25e"),
        (0xe2b9, "check_link_status_e2b9"),
        (0xe396, "helper_e396"),
        (0xe3d8, "usb_state_event_handler"),
        (0xe3f9, "flash_read_status"),
        (0xe5b1, "check_usb_phy_link_idle_e5b1"),
        (0xe617, "helper_0412"),
        (0xe6d2, "helper_e6d2"),
        (0xe73a, "cmd_engine_clear"),
        (0xe7ae, "uart_wait_tx_ready"),
        (0xe7c1, "helper_e7c1"),
        (0xe89d, "delay_short_e89d"),
        (0xe914, "ext_mem_access_wrapper_e914"),
        (0xe93a, "cpu_dma_channel_91_trigger_e93a"),
        (0xe974, "pcie_handler_e974"),
    ]

    count = 0
    for addr_int, name in functions:
        try:
            # Bank 0 functions are in CODE space at their actual address
            addr = toAddr("CODE:{:04X}".format(addr_int))
            if create_function_if_needed(addr, name):
                count += 1
        except:
            try:
                addr = toAddr(addr_int)
                if create_function_if_needed(addr, name):
                    count += 1
            except Exception as e:
                print("Error adding Bank 0 function {} at 0x{:04X}: {}".format(name, addr_int, e))

    return count

def add_bank1_functions():
    """Add all known Bank 1 function names (file offset 0x10000-0x17FFF, CPU addr 0x8000-0xFFFF)"""

    # Bank 1 Function mappings: (file_offset, name)
    # File offset = CPU address + 0x8000 for addresses >= 0x8000
    # CPU addresses in Bank 1 are 0x8000-0xFFFF but mapped from file 0x10000-0x17FFF
    #
    # In Ghidra with CODE_BANK1 overlay:
    #   - Use file offset directly (0x10000+) OR
    #   - Use CPU addr + CODE_BANK1 overlay
    functions = [
        (0x1039c, "pcie_addr_store_839c"),
        (0x103b9, "pcie_addr_store_83b9"),
        (0x1073a, "flash_dispatch_stub_873a"),
        (0x10743, "flash_dispatch_stub_8743"),
        (0x1074c, "flash_dispatch_stub_874c"),
        (0x1097d, "usb_desc_setup_897d"),
        (0x10992, "usb_desc_setup_8992"),
        (0x109ad, "usb_desc_setup_89ad"),
        (0x109bd, "usb_desc_setup_89bd"),
        (0x109c6, "usb_desc_setup_89c6"),
        (0x10a3a, "usb_xfer_nop_8a3a"),
        (0x10a3d, "usb_xfer_finish_8a3d"),
        (0x10a4e, "usb_xfer_setup_8a4e"),
        (0x10a67, "usb_xfer_setup_8a67"),
        (0x10a72, "usb_xfer_setup_8a72"),
        (0x10a7e, "usb_xfer_setup_8a7e"),
        (0x10a89, "usb_xfer_flash_dispatch_8a89"),
        (0x10d6e, "flash_dispatch_stub_8d6e"),
        (0x10d77, "system_init_from_flash"),
        (0x12066, "error_handler_pcie_bit5"),
        (0x12f5e, "uart_newline"),
        (0x13230, "error_handler_recovery"),
        (0x1343c, "vendor_cmd_e5_xdata_write"),
        (0x13473, "vendor_cmd_e4_xdata_read"),
        (0x1600c, "get_pcie_status_flags_e00c"),
        (0x1619e, "pcie_channel_setup_e19e"),
        (0x16330, "pcie_dma_config_e330"),
        (0x16529, "delay_function"),
        (0x1656f, "event_state_machine_e56f"),
        (0x1657d, "timer_phy_config_e57d"),
        (0x165fe, "pcie_channel_disable_e5fe"),
        (0x16647, "power_check_status_e647"),
        (0x16677, "status_update_handler_e677"),
        (0x1668f, "dma_buffer_store_result_e68f"),
        (0x166fc, "dma_poll_link_ready"),
        (0x16726, "timer_wait"),
        (0x1674e, "pcie_disable_and_trigger_e74e"),
        (0x16762, "event_queue_process_e762"),
        (0x16775, "pcie_txn_setup_e775"),
        (0x1680a, "pcie_wait_and_ack_e80a"),
        (0x1681b, "cpu_dma_setup_e81b"),
        (0x1684d, "pcie_save_ctrl_state"),
        (0x1685c, "pcie_restore_ctrl_state"),
        (0x16883, "timer_pcie_async_event"),
        (0x16890, "pcie_handler_e890"),
        (0x168cd, "clear_pcie_status_bytes_e8cd"),
        (0x168ef, "pcie_trigger_cc11_e8ef"),
        (0x168f9, "pcie_init_read_e8f9"),
        (0x16902, "pcie_init_write_e902"),
        (0x16911, "error_handler_pcie_nvme"),
        (0x16920, "error_clear_system_flags"),
        (0x16933, "cpu_int_ctrl_trigger_e933"),
        (0x16d02, "pcie_state_clear_ed02"),
        (0x16d20, "pcie_nvme_event_handler"),
        (0x16d90, "pcie_error_dispatch"),
        (0x16e00, "pcie_event_bit5_handler"),
        (0x16e50, "pcie_timer_bit4_handler"),
        (0x16ef9, "pcie_handler_unused_eef9"),
        (0x16f4e, "error_handler_system_timer"),
    ]

    count = 0
    for file_offset, name in functions:
        try:
            # Convert file offset to CPU address for CODE_BANK1 overlay
            # File offset 0x10000 = CPU 0x8000, so CPU addr = file_offset - 0x8000
            cpu_addr = file_offset - 0x8000
            addr = toAddr("CODE_BANK1:{:04X}".format(cpu_addr))
            if create_function_if_needed(addr, name):
                count += 1
        except:
            try:
                # Try direct file offset
                addr = toAddr(file_offset)
                if create_function_if_needed(addr, name):
                    count += 1
            except Exception as e:
                print("Error adding Bank 1 function {} at file offset 0x{:05X}: {}".format(name, file_offset, e))

    return count

def add_registers():
    """Add all known register labels to EXTMEM space"""

    # Register mappings: (address, name)
    # These are hardware registers (>= 0x6000)
    registers = [
        (0x7041, "REG_FLASH_BUF_CTRL_7041"),
        (0x78AF, "REG_FLASH_BUF_CFG_78AF"),
        (0x78B0, "REG_FLASH_BUF_CFG_78B0"),
        (0x78B1, "REG_FLASH_BUF_CFG_78B1"),
        (0x78B2, "REG_FLASH_BUF_CFG_78B2"),
        (0x8008, "REG_USB_BUF_CTRL_8008"),
        (0x8009, "REG_USB_BUF_CTRL_8009"),
        (0x800A, "REG_USB_BUF_CTRL_800A"),
        (0x800D, "REG_USB_BUF_STATUS_800D"),
        (0x9000, "REG_USB_STATUS"),
        (0x9001, "REG_USB_CONTROL"),
        (0x9002, "REG_USB_CONFIG"),
        (0x9003, "REG_USB_EP0_STATUS"),
        (0x9004, "REG_USB_EP0_LEN_L"),
        (0x9005, "REG_USB_EP0_LEN_H"),
        (0x9006, "REG_USB_EP0_CONFIG"),
        (0x9007, "REG_USB_SCSI_BUF_LEN"),
        (0x9008, "REG_USB_SCSI_BUF_LEN_H"),
        (0x900B, "REG_USB_MSC_CFG"),
        (0x9010, "REG_USB_DATA_L"),
        (0x9011, "REG_USB_DATA_H"),
        (0x9012, "REG_USB_FIFO_STATUS"),
        (0x9013, "REG_USB_FIFO_H"),
        (0x9018, "REG_USB_XCVR_MODE"),
        (0x9019, "REG_USB_MODE_VAL_9019"),
        (0x901A, "REG_USB_MSC_LENGTH"),
        (0x905A, "REG_USB_EP_CFG_905A"),
        (0x905B, "REG_USB_EP_BUF_HI"),
        (0x905C, "REG_USB_EP_BUF_LO"),
        (0x905E, "REG_USB_EP_MGMT"),
        (0x905F, "REG_USB_EP_CTRL_905F"),
        (0x9090, "REG_USB_INT_MASK_9090"),
        (0x9091, "REG_INT_FLAGS_EX0"),
        (0x9092, "REG_TLP_CMD_TRIGGER"),
        (0x9093, "REG_USB_EP_CFG1"),
        (0x9094, "REG_USB_EP_CFG2"),
        (0x9096, "REG_USB_EP_READY"),
        (0x909E, "REG_USB_STATUS_909E"),
        (0x90A0, "REG_USB_CTRL_90A0"),
        (0x90A1, "REG_USB_SIGNAL_90A1"),
        (0x90E0, "REG_USB_SPEED"),
        (0x90E2, "REG_USB_MODE"),
        (0x90E3, "REG_USB_EP_STATUS_90E3"),
        (0x9100, "REG_USB_LINK_STATUS"),
        (0x9101, "REG_USB_PERIPH_STATUS"),
        (0x9105, "REG_USB_PHY_STATUS_9105"),
        (0x910D, "REG_USB_STAT_EXT_L"),
        (0x910E, "REG_USB_STAT_EXT_H"),
        (0x9118, "REG_USB_EP_STATUS"),
        (0x9119, "REG_USB_CBW_LEN_HI"),
        (0x911A, "REG_USB_CBW_LEN_LO"),
        (0x911B, "REG_USB_BUFFER_ALT"),
        (0x911C, "REG_USB_CBW_SIG1"),
        (0x911D, "REG_USB_CBW_SIG2"),
        (0x911E, "REG_USB_CBW_SIG3"),
        (0x911F, "REG_CBW_TAG_0"),
        (0x9120, "REG_CBW_TAG_1"),
        (0x9121, "REG_CBW_TAG_2"),
        (0x9122, "REG_CBW_TAG_3"),
        (0x9123, "REG_USB_CBW_XFER_LEN_0"),
        (0x9124, "REG_USB_CBW_XFER_LEN_1"),
        (0x9125, "REG_USB_CBW_XFER_LEN_2"),
        (0x9126, "REG_USB_CBW_XFER_LEN_3"),
        (0x9127, "REG_USB_CBW_FLAGS"),
        (0x9128, "REG_USB_CBW_LUN"),
        (0x91C0, "REG_USB_PHY_CTRL_91C0"),
        (0x91C1, "REG_USB_PHY_CTRL_91C1"),
        (0x91C3, "REG_USB_PHY_CTRL_91C3"),
        (0x91D0, "REG_USB_EP_CTRL_91D0"),
        (0x91D1, "REG_USB_PHY_CTRL_91D1"),
        (0x9200, "REG_USB_CTRL_9200"),
        (0x9201, "REG_USB_CTRL_9201"),
        (0x920C, "REG_USB_CTRL_920C"),
        (0x9241, "REG_USB_PHY_CONFIG_9241"),
        (0x924C, "REG_USB_CTRL_924C"),
        (0x92C0, "REG_POWER_ENABLE"),
        (0x92C1, "REG_CLOCK_ENABLE"),
        (0x92C2, "REG_POWER_STATUS"),
        (0x92C4, "REG_POWER_MISC_CTRL"),
        (0x92C5, "REG_PHY_POWER"),
        (0x92C6, "REG_POWER_CTRL_92C6"),
        (0x92C7, "REG_POWER_CTRL_92C7"),
        (0x92C8, "REG_POWER_CTRL_92C8"),
        (0x92E0, "REG_POWER_DOMAIN"),
        (0x92E1, "REG_POWER_EVENT_92E1"),
        (0x92F7, "REG_POWER_STATUS_92F7"),
        (0x9300, "REG_BUF_CFG_9300"),
        (0x9301, "REG_BUF_CFG_9301"),
        (0x9302, "REG_BUF_CFG_9302"),
        (0x9303, "REG_BUF_CFG_9303"),
        (0x9304, "REG_BUF_CFG_9304"),
        (0x9305, "REG_BUF_CFG_9305"),
        (0x9E00, "REG_USB_CTRL_BUF_9E00"),
        (0xB210, "REG_PCIE_FMT_TYPE"),
        (0xB213, "REG_PCIE_TLP_CTRL"),
        (0xB216, "REG_PCIE_TLP_LENGTH"),
        (0xB217, "REG_PCIE_BYTE_EN"),
        (0xB218, "REG_PCIE_ADDR_0"),
        (0xB219, "REG_PCIE_ADDR_1"),
        (0xB21A, "REG_PCIE_ADDR_2"),
        (0xB21B, "REG_PCIE_ADDR_3"),
        (0xB21C, "REG_PCIE_ADDR_HIGH"),
        (0xB220, "REG_PCIE_DATA"),
        (0xB223, "REG_PCIE_EXT_STATUS"),
        (0xB224, "REG_PCIE_TLP_CPL_HEADER"),
        (0xB22A, "REG_PCIE_LINK_STATUS"),
        (0xB22B, "REG_PCIE_CPL_STATUS"),
        (0xB22C, "REG_PCIE_CPL_DATA"),
        (0xB22D, "REG_PCIE_CPL_DATA_ALT"),
        (0xB234, "REG_PCIE_LINK_STATE_EXT"),
        (0xB235, "REG_PCIE_LINK_CFG"),
        (0xB236, "REG_PCIE_LINK_PARAM"),
        (0xB237, "REG_PCIE_LINK_STATUS_EXT"),
        (0xB238, "REG_PCIE_LINK_TRIGGER"),
        (0xB23C, "REG_PCIE_EXT_CFG_0"),
        (0xB23D, "REG_PCIE_EXT_CFG_1"),
        (0xB23E, "REG_PCIE_EXT_CFG_2"),
        (0xB23F, "REG_PCIE_EXT_CFG_3"),
        (0xB240, "REG_PCIE_EXT_STATUS_RD"),
        (0xB241, "REG_PCIE_EXT_STATUS_RD1"),
        (0xB242, "REG_PCIE_EXT_STATUS_RD2"),
        (0xB243, "REG_PCIE_EXT_STATUS_RD3"),
        (0xB24E, "REG_PCIE_EXT_STATUS_ALT"),
        (0xB250, "REG_PCIE_NVME_DOORBELL"),
        (0xB251, "REG_PCIE_DOORBELL_CMD"),
        (0xB254, "REG_PCIE_TRIGGER"),
        (0xB255, "REG_PCIE_PM_ENTER"),
        (0xB284, "REG_PCIE_COMPL_STATUS"),
        (0xB294, "REG_PCIE_POWER_B294"),
        (0xB296, "REG_PCIE_STATUS"),
        (0xB298, "REG_PCIE_TUNNEL_CFG"),
        (0xB2D5, "REG_PCIE_CTRL_B2D5"),
        (0xB401, "REG_PCIE_TUNNEL_CTRL"),
        (0xB402, "REG_PCIE_CTRL_B402"),
        (0xB404, "REG_PCIE_LINK_PARAM_B404"),
        (0xB410, "REG_TUNNEL_CFG_A_LO"),
        (0xB411, "REG_TUNNEL_CFG_A_HI"),
        (0xB412, "REG_TUNNEL_CREDITS"),
        (0xB413, "REG_TUNNEL_CFG_MODE"),
        (0xB415, "REG_TUNNEL_CAP_0"),
        (0xB416, "REG_TUNNEL_CAP_1"),
        (0xB417, "REG_TUNNEL_CAP_2"),
        (0xB418, "REG_TUNNEL_PATH_CREDITS"),
        (0xB419, "REG_TUNNEL_PATH_MODE"),
        (0xB41A, "REG_TUNNEL_LINK_CFG_LO"),
        (0xB41B, "REG_TUNNEL_LINK_CFG_HI"),
        (0xB420, "REG_TUNNEL_DATA_LO"),
        (0xB421, "REG_TUNNEL_DATA_HI"),
        (0xB422, "REG_TUNNEL_STATUS_0"),
        (0xB423, "REG_TUNNEL_STATUS_1"),
        (0xB424, "REG_PCIE_LANE_COUNT"),
        (0xB425, "REG_TUNNEL_CAP2_0"),
        (0xB426, "REG_TUNNEL_CAP2_1"),
        (0xB427, "REG_TUNNEL_CAP2_2"),
        (0xB428, "REG_TUNNEL_PATH2_CRED"),
        (0xB429, "REG_TUNNEL_PATH2_MODE"),
        (0xB42A, "REG_TUNNEL_AUX_CFG_LO"),
        (0xB42B, "REG_TUNNEL_AUX_CFG_HI"),
        (0xB430, "REG_TUNNEL_LINK_STATE"),
        (0xB432, "REG_POWER_CTRL_B432"),
        (0xB434, "REG_PCIE_LINK_STATE"),
        (0xB436, "REG_PCIE_LANE_CONFIG"),
        (0xB455, "REG_POWER_CTRL_B455"),
        (0xB480, "REG_TUNNEL_LINK_CTRL"),
        (0xB482, "REG_TUNNEL_ADAPTER_MODE"),
        (0xB4AE, "REG_PCIE_LINK_STATUS_ALT"),
        (0xB4C8, "REG_PCIE_LANE_MASK"),
        (0xB80C, "REG_PCIE_QUEUE_INDEX_LO"),
        (0xB80D, "REG_PCIE_QUEUE_INDEX_HI"),
        (0xB80E, "REG_PCIE_QUEUE_FLAGS_LO"),
        (0xB80F, "REG_PCIE_QUEUE_FLAGS_HI"),
        (0xC000, "REG_UART_BASE"),
        (0xC001, "REG_UART_THR"),
        (0xC002, "REG_UART_IER"),
        (0xC004, "REG_UART_FCR"),
        (0xC006, "REG_UART_TFBF"),
        (0xC007, "REG_UART_LCR"),
        (0xC008, "REG_UART_MCR"),
        (0xC009, "REG_UART_LSR"),
        (0xC00A, "REG_UART_MSR"),
        (0xC00E, "REG_UART_STATUS"),
        (0xC202, "REG_LINK_CTRL"),
        (0xC203, "REG_LINK_CONFIG"),
        (0xC204, "REG_LINK_STATUS"),
        (0xC205, "REG_PHY_CTRL"),
        (0xC208, "REG_PHY_LINK_CTRL_C208"),
        (0xC20C, "REG_PHY_LINK_CONFIG_C20C"),
        (0xC233, "REG_PHY_CONFIG"),
        (0xC284, "REG_PHY_STATUS"),
        (0xC2E0, "REG_PHY_VENDOR_CTRL_C2E0"),
        (0xC2E2, "REG_PHY_VENDOR_CTRL_C2E2"),
        (0xC343, "REG_VENDOR_CTRL_C343"),
        (0xC360, "REG_VENDOR_CTRL_C360"),
        (0xC362, "REG_VENDOR_CTRL_C362"),
        (0xC400, "REG_NVME_CTRL"),
        (0xC401, "REG_NVME_STATUS"),
        (0xC412, "REG_NVME_CTRL_STATUS"),
        (0xC413, "REG_NVME_CONFIG"),
        (0xC414, "REG_NVME_DATA_CTRL"),
        (0xC415, "REG_NVME_DEV_STATUS"),
        (0xC420, "REG_NVME_CMD"),
        (0xC421, "REG_NVME_CMD_OPCODE"),
        (0xC422, "REG_NVME_LBA_LOW"),
        (0xC423, "REG_NVME_LBA_MID"),
        (0xC424, "REG_NVME_LBA_HIGH"),
        (0xC425, "REG_NVME_COUNT_LOW"),
        (0xC426, "REG_NVME_COUNT_HIGH"),
        (0xC427, "REG_NVME_ERROR"),
        (0xC428, "REG_NVME_QUEUE_CFG"),
        (0xC429, "REG_NVME_CMD_PARAM"),
        (0xC42A, "REG_NVME_DOORBELL"),
        (0xC42B, "REG_NVME_CMD_FLAGS"),
        (0xC42C, "REG_USB_MSC_CTRL"),
        (0xC42D, "REG_USB_MSC_STATUS"),
        (0xC431, "REG_NVME_CMD_PRP2"),
        (0xC435, "REG_NVME_CMD_CDW10"),
        (0xC438, "REG_NVME_INIT_CTRL"),
        (0xC439, "REG_NVME_CMD_CDW11"),
        (0xC43A, "REG_NVME_INT_MASK_A"),
        (0xC43B, "REG_NVME_INT_MASK_B"),
        (0xC43D, "REG_NVME_QUEUE_PTR"),
        (0xC43E, "REG_NVME_QUEUE_DEPTH"),
        (0xC43F, "REG_NVME_PHASE"),
        (0xC440, "REG_NVME_QUEUE_CTRL"),
        (0xC441, "REG_NVME_SQ_HEAD"),
        (0xC442, "REG_NVME_SQ_TAIL"),
        (0xC443, "REG_NVME_CQ_HEAD"),
        (0xC444, "REG_NVME_CQ_TAIL"),
        (0xC445, "REG_NVME_CQ_STATUS"),
        (0xC446, "REG_NVME_LBA_3"),
        (0xC448, "REG_NVME_INIT_CTRL2"),
        (0xC450, "REG_NVME_CMD_STATUS_50"),
        (0xC451, "REG_NVME_QUEUE_STATUS_51"),
        (0xC462, "REG_DMA_ENTRY"),
        (0xC470, "REG_CMDQ_DIR_END"),
        (0xC471, "REG_NVME_QUEUE_BUSY"),
        (0xC472, "REG_NVME_LINK_CTRL"),
        (0xC47A, "REG_NVME_CMD_STATUS_C47A"),
        (0xC4C0, "REG_NVME_SCSI_CMD_BUF_0"),
        (0xC4C1, "REG_NVME_SCSI_CMD_BUF_1"),
        (0xC4C2, "REG_NVME_SCSI_CMD_BUF_2"),
        (0xC4C3, "REG_NVME_SCSI_CMD_BUF_3"),
        (0xC4C4, "REG_NVME_SCSI_CMD_LEN_0"),
        (0xC4C5, "REG_NVME_SCSI_CMD_LEN_1"),
        (0xC4C6, "REG_NVME_SCSI_CMD_LEN_2"),
        (0xC4C7, "REG_NVME_SCSI_CMD_LEN_3"),
        (0xC4C8, "REG_NVME_SCSI_TAG"),
        (0xC4C9, "REG_NVME_SCSI_CTRL"),
        (0xC4CA, "REG_NVME_SCSI_DATA"),
        (0xC4E9, "REG_NVME_DMA_CTRL_C4E9"),
        (0xC4EA, "REG_NVME_PARAM_C4EA"),
        (0xC4EB, "REG_NVME_PARAM_C4EB"),
        (0xC4ED, "REG_NVME_DMA_CTRL_ED"),
        (0xC4EE, "REG_NVME_DMA_ADDR_LO"),
        (0xC4EF, "REG_NVME_DMA_ADDR_HI"),
        (0xC508, "REG_NVME_BUF_CFG"),
        (0xC512, "REG_NVME_QUEUE_INDEX"),
        (0xC516, "REG_NVME_QUEUE_PENDING"),
        (0xC51A, "REG_NVME_QUEUE_TRIGGER"),
        (0xC51E, "REG_NVME_QUEUE_STATUS"),
        (0xC520, "REG_NVME_LINK_STATUS"),
        (0xC62D, "REG_PHY_EXT_2D"),
        (0xC655, "REG_PHY_CFG_C655"),
        (0xC656, "REG_PHY_EXT_56"),
        (0xC659, "REG_PCIE_LANE_CTRL_C659"),
        (0xC65A, "REG_PHY_CFG_C65A"),
        (0xC65B, "REG_PHY_EXT_5B"),
        (0xC6A8, "REG_PHY_CFG_C6A8"),
        (0xC6B3, "REG_PHY_EXT_B3"),
        (0xC6BD, "REG_PHY_LINK_CTRL_BD"),
        (0xC6DB, "REG_PHY_VENDOR_CTRL_C6DB"),
        (0xC800, "REG_INT_STATUS_C800"),
        (0xC801, "REG_INT_ENABLE"),
        (0xC802, "REG_INT_USB_STATUS"),
        (0xC805, "REG_INT_AUX_STATUS"),
        (0xC806, "REG_INT_SYSTEM"),
        (0xC809, "REG_INT_CTRL"),
        (0xC80A, "REG_INT_PCIE_NVME"),
        (0xC870, "REG_I2C_ADDR"),
        (0xC871, "REG_I2C_MODE"),
        (0xC873, "REG_I2C_LEN"),
        (0xC875, "REG_I2C_CSR"),
        (0xC878, "REG_I2C_SRC"),
        (0xC87C, "REG_I2C_DST"),
        (0xC87F, "REG_I2C_CSR_ALT"),
        (0xC880, "REG_FLASH_CMD_ALT"),
        (0xC881, "REG_FLASH_CSR_ALT"),
        (0xC882, "REG_FLASH_ADDR_LO_ALT"),
        (0xC883, "REG_FLASH_ADDR_MD_ALT"),
        (0xC884, "REG_FLASH_ADDR_HI_ALT"),
        (0xC885, "REG_FLASH_DATA_LEN_ALT"),
        (0xC886, "REG_FLASH_DATA_HI_ALT"),
        (0xC89F, "REG_FLASH_CON"),
        (0xC8A1, "REG_FLASH_ADDR_LO"),
        (0xC8A2, "REG_FLASH_ADDR_MD"),
        (0xC8A3, "REG_FLASH_DATA_LEN"),
        (0xC8A4, "REG_FLASH_DATA_LEN_HI"),
        (0xC8A6, "REG_FLASH_DIV"),
        (0xC8A9, "REG_FLASH_CSR"),
        (0xC8AA, "REG_FLASH_CMD"),
        (0xC8AB, "REG_FLASH_ADDR_HI"),
        (0xC8AC, "REG_FLASH_ADDR_LEN"),
        (0xC8AD, "REG_FLASH_MODE"),
        (0xC8AE, "REG_FLASH_BUF_OFFSET"),
        (0xC8B0, "REG_DMA_MODE"),
        (0xC8B2, "REG_DMA_CHAN_AUX"),
        (0xC8B3, "REG_DMA_CHAN_AUX1"),
        (0xC8B4, "REG_DMA_XFER_CNT_HI"),
        (0xC8B5, "REG_DMA_XFER_CNT_LO"),
        (0xC8B6, "REG_DMA_CHAN_CTRL2"),
        (0xC8B7, "REG_DMA_CHAN_STATUS2"),
        (0xC8B8, "REG_DMA_TRIGGER"),
        (0xC8D4, "REG_DMA_CONFIG"),
        (0xC8D5, "REG_DMA_QUEUE_IDX"),
        (0xC8D6, "REG_DMA_STATUS"),
        (0xC8D7, "REG_DMA_CTRL"),
        (0xC8D8, "REG_DMA_STATUS2"),
        (0xC8D9, "REG_DMA_STATUS3"),
        (0xCA06, "REG_CPU_MODE_NEXT"),
        (0xCA60, "REG_CPU_CTRL_CA60"),
        (0xCA81, "REG_CPU_CTRL_CA81"),
        (0xCC10, "REG_TIMER0_DIV"),
        (0xCC11, "REG_TIMER0_CSR"),
        (0xCC12, "REG_TIMER0_THRESHOLD"),
        (0xCC13, "REG_TIMER0_THRESHOLD_LO"),
        (0xCC16, "REG_TIMER1_DIV"),
        (0xCC17, "REG_TIMER1_CSR"),
        (0xCC18, "REG_TIMER1_THRESHOLD"),
        (0xCC1C, "REG_TIMER2_DIV"),
        (0xCC1D, "REG_TIMER2_CSR"),
        (0xCC1E, "REG_TIMER2_THRESHOLD"),
        (0xCC1F, "REG_TIMER2_THRESHOLD_HI"),
        (0xCC22, "REG_TIMER3_DIV"),
        (0xCC23, "REG_TIMER3_CSR"),
        (0xCC24, "REG_TIMER3_IDLE_TIMEOUT"),
        (0xCC30, "REG_CPU_MODE"),
        (0xCC31, "REG_CPU_EXEC_CTRL"),
        (0xCC32, "REG_CPU_EXEC_STATUS"),
        (0xCC33, "REG_CPU_EXEC_STATUS_2"),
        (0xCC34, "REG_CPU_EXEC_CTRL_2"),
        (0xCC35, "REG_CPU_EXEC_STATUS_3"),
        (0xCC38, "REG_TIMER_ENABLE_A"),
        (0xCC3A, "REG_TIMER_ENABLE_B"),
        (0xCC3B, "REG_TIMER_CTRL_CC3B"),
        (0xCC3D, "REG_CPU_CTRL_CC3D"),
        (0xCC3E, "REG_CPU_CTRL_CC3E"),
        (0xCC3F, "REG_CPU_CTRL_CC3F"),
        (0xCC5C, "REG_TIMER4_DIV"),
        (0xCC5D, "REG_TIMER4_CSR"),
        (0xCC5E, "REG_TIMER4_THRESHOLD_LO"),
        (0xCC5F, "REG_TIMER4_THRESHOLD_HI"),
        (0xCC80, "REG_CPU_CTRL_CC80"),
        (0xCC81, "REG_CPU_INT_CTRL"),
        (0xCC82, "REG_CPU_CTRL_CC82"),
        (0xCC83, "REG_CPU_CTRL_CC83"),
        (0xCC88, "REG_XFER_DMA_CTRL"),
        (0xCC89, "REG_XFER_DMA_CMD"),
        (0xCC8A, "REG_XFER_DMA_ADDR_LO"),
        (0xCC8B, "REG_XFER_DMA_ADDR_HI"),
        (0xCC91, "REG_CPU_DMA_INT"),
        (0xCC98, "REG_CPU_DMA_READY"),
        (0xCC99, "REG_XFER_DMA_CFG"),
        (0xCC9A, "REG_XFER_DMA_DATA_LO"),
        (0xCC9B, "REG_XFER_DMA_DATA_HI"),
        (0xCCB9, "REG_TIMER5_CSR"),
        (0xCCD8, "REG_XFER2_DMA_CTRL"),
        (0xCCD9, "REG_XFER2_DMA_STATUS"),
        (0xCCDA, "REG_XFER2_DMA_ADDR_LO"),
        (0xCCDB, "REG_XFER2_DMA_ADDR_HI"),
        (0xCCF8, "REG_CPU_EXT_CTRL"),
        (0xCCF9, "REG_CPU_EXT_STATUS"),
        (0xCD31, "REG_CPU_TIMER_CTRL_CD31"),
        (0xCE00, "REG_SCSI_DMA_CTRL"),
        (0xCE01, "REG_SCSI_DMA_PARAM"),
        (0xCE36, "REG_SCSI_DMA_CFG_CE36"),
        (0xCE3A, "REG_SCSI_DMA_TAG_CE3A"),
        (0xCE40, "REG_SCSI_DMA_PARAM0"),
        (0xCE41, "REG_SCSI_DMA_PARAM1"),
        (0xCE42, "REG_SCSI_DMA_PARAM2"),
        (0xCE43, "REG_SCSI_DMA_PARAM3"),
        (0xCE44, "REG_SCSI_DMA_PARAM4"),
        (0xCE45, "REG_SCSI_DMA_PARAM5"),
        (0xCE51, "REG_SCSI_TAG_IDX"),
        (0xCE55, "REG_SCSI_TAG_VALUE"),
        (0xCE5C, "REG_SCSI_DMA_COMPL"),
        (0xCE5D, "REG_SCSI_DMA_MASK"),
        (0xCE5F, "REG_SCSI_DMA_QUEUE"),
        (0xCE60, "REG_XFER_STATUS_CE60"),
        (0xCE65, "REG_XFER_CTRL_CE65"),
        (0xCE66, "REG_SCSI_DMA_TAG_COUNT"),
        (0xCE67, "REG_SCSI_DMA_QUEUE_STAT"),
        (0xCE6C, "REG_XFER_STATUS_CE6C"),
        (0xCE6E, "REG_SCSI_DMA_STATUS"),
        (0xCE6F, "REG_SCSI_DMA_STATUS_H"),
        (0xCE70, "REG_SCSI_TRANSFER_CTRL"),
        (0xCE72, "REG_SCSI_TRANSFER_MODE"),
        (0xCE73, "REG_SCSI_BUF_CTRL0"),
        (0xCE74, "REG_SCSI_BUF_CTRL1"),
        (0xCE75, "REG_SCSI_BUF_LEN_LO"),
        (0xCE76, "REG_SCSI_BUF_ADDR0"),
        (0xCE77, "REG_SCSI_BUF_ADDR1"),
        (0xCE78, "REG_SCSI_BUF_ADDR2"),
        (0xCE79, "REG_SCSI_BUF_ADDR3"),
        (0xCE80, "REG_SCSI_BUF_CTRL"),
        (0xCE81, "REG_SCSI_BUF_THRESH_HI"),
        (0xCE82, "REG_SCSI_BUF_THRESH_LO"),
        (0xCE83, "REG_SCSI_BUF_FLOW"),
        (0xCE86, "REG_XFER_STATUS_CE86"),
        (0xCE88, "REG_XFER_CTRL_CE88"),
        (0xCE89, "REG_XFER_READY"),
        (0xCE8A, "REG_XFER_CTRL_CE8A"),
        (0xCE95, "REG_XFER_MODE_CE95"),
        (0xCE96, "REG_SCSI_DMA_CMD_REG"),
        (0xCE97, "REG_SCSI_DMA_RESP_REG"),
        (0xCEB2, "REG_USB_DESC_VAL_CEB2"),
        (0xCEB3, "REG_USB_DESC_VAL_CEB3"),
        (0xCEF2, "REG_CPU_LINK_CEF2"),
        (0xCEF3, "REG_CPU_LINK_CEF3"),
        (0xD800, "REG_USB_EP_BUF_CTRL"),
        (0xD801, "REG_USB_EP_BUF_SEL"),
        (0xD802, "REG_USB_EP_BUF_DATA"),
        (0xD803, "REG_USB_EP_BUF_PTR_LO"),
        (0xD804, "REG_USB_EP_BUF_PTR_HI"),
        (0xD805, "REG_USB_EP_BUF_LEN_LO"),
        (0xD806, "REG_USB_EP_BUF_STATUS"),
        (0xD807, "REG_USB_EP_BUF_LEN_HI"),
        (0xD808, "REG_USB_EP_RESIDUE0"),
        (0xD809, "REG_USB_EP_RESIDUE1"),
        (0xD80A, "REG_USB_EP_RESIDUE2"),
        (0xD80B, "REG_USB_EP_RESIDUE3"),
        (0xD80C, "REG_USB_EP_CSW_STATUS"),
        (0xD80D, "REG_USB_EP_CTRL_0D"),
        (0xD80E, "REG_USB_EP_CTRL_0E"),
        (0xD80F, "REG_USB_EP_CTRL_0F"),
        (0xD810, "REG_USB_EP_CTRL_10"),
        (0xE302, "REG_PHY_MODE_E302"),
        (0xE314, "REG_DEBUG_STATUS_E314"),
        (0xE318, "REG_PHY_COMPLETION_E318"),
        (0xE324, "REG_LINK_CTRL_E324"),
        (0xE402, "REG_CMD_STATUS_E402"),
        (0xE403, "REG_CMD_CTRL_E403"),
        (0xE404, "REG_CMD_CFG_E404"),
        (0xE405, "REG_CMD_CFG_E405"),
        (0xE40B, "REG_CMD_CONFIG"),
        (0xE40F, "REG_CMD_CTRL_E40F"),
        (0xE410, "REG_CMD_CTRL_E410"),
        (0xE41C, "REG_CMD_BUSY_STATUS"),
        (0xE420, "REG_CMD_TRIGGER"),
        (0xE421, "REG_CMD_MODE_E421"),
        (0xE422, "REG_CMD_PARAM"),
        (0xE423, "REG_CMD_STATUS"),
        (0xE424, "REG_CMD_ISSUE"),
        (0xE425, "REG_CMD_TAG"),
        (0xE426, "REG_CMD_LBA_0"),
        (0xE427, "REG_CMD_LBA_1"),
        (0xE428, "REG_CMD_LBA_2"),
        (0xE429, "REG_CMD_LBA_3"),
        (0xE42A, "REG_CMD_COUNT_LOW"),
        (0xE42B, "REG_CMD_COUNT_HIGH"),
        (0xE42C, "REG_CMD_LENGTH_LOW"),
        (0xE42D, "REG_CMD_LENGTH_HIGH"),
        (0xE42E, "REG_CMD_RESP_TAG"),
        (0xE42F, "REG_CMD_RESP_STATUS"),
        (0xE430, "REG_CMD_CTRL"),
        (0xE431, "REG_CMD_TIMEOUT"),
        (0xE432, "REG_CMD_PARAM_L"),
        (0xE433, "REG_CMD_PARAM_H"),
        (0xE434, "REG_CMD_EXT_PARAM_0"),
        (0xE435, "REG_CMD_EXT_PARAM_1"),
        (0xE62F, "REG_DEBUG_INT_E62F"),
        (0xE65F, "REG_DEBUG_INT_E65F"),
        (0xE661, "REG_DEBUG_INT_E661"),
        (0xE710, "REG_LINK_WIDTH_E710"),
        (0xE712, "REG_LINK_STATUS_E712"),
        (0xE716, "REG_LINK_STATUS_E716"),
        (0xE717, "REG_LINK_CTRL_E717"),
        (0xE760, "REG_SYS_CTRL_E760"),
        (0xE761, "REG_SYS_CTRL_E761"),
        (0xE763, "REG_SYS_CTRL_E763"),
        (0xE764, "REG_PHY_TIMER_CTRL_E764"),
        (0xE765, "REG_SYS_CTRL_E765"),
        (0xE795, "REG_FLASH_READY_STATUS"),
        (0xE7E3, "REG_PHY_LINK_CTRL"),
        (0xE7FA, "REG_PHY_LINK_TRIGGER"),
        (0xE7FC, "REG_LINK_MODE_CTRL"),
        (0xEA90, "REG_SYS_CTRL_EA90"),
        (0xEC04, "REG_NVME_EVENT_ACK"),
        (0xEC06, "REG_NVME_EVENT_STATUS"),
        (0xEF4E, "REG_CRITICAL_CTRL"),
    ]

    count = 0
    for addr_int, name in registers:
        try:
            # Try EXTMEM space first
            addr = toAddr("EXTMEM:{:04X}".format(addr_int))
            if create_label(addr, name):
                count += 1
        except:
            try:
                # Fall back to direct address
                addr = toAddr(addr_int)
                if create_label(addr, name):
                    count += 1
            except Exception as e:
                print("Error adding register {} at 0x{:04X}: {}".format(name, addr_int, e))

    return count

def add_globals():
    """Add all known global variable labels to EXTMEM space"""

    # Global variable mappings: (address, name)
    # These are RAM locations (< 0x6000)
    globals_list = [
        (0x0000, "G_SYSTEM_CTRL"),
        (0x0001, "G_IO_CMD_TYPE"),
        (0x0002, "G_IO_CMD_STATE"),
        (0x0003, "G_EP_STATUS_CTRL"),
        (0x0006, "G_WORK_0006"),
        (0x0007, "G_WORK_0007"),
        (0x0009, "IDATA_I_BOOT_SIG_0"),
        (0x000A, "G_USB_CTRL_000A"),
        (0x000B, "IDATA_I_BOOT_SIG_2"),
        (0x000C, "IDATA_I_BOOT_SIG_3"),
        (0x000D, "IDATA_I_QUEUE_IDX"),
        (0x0011, "IDATA_I_SCSI_TAG"),
        (0x0012, "IDATA_I_WORK_12"),
        (0x0013, "IDATA_I_WORK_13"),
        (0x0014, "IDATA_I_WORK_14"),
        (0x0015, "IDATA_I_WORK_15"),
        (0x0016, "IDATA_I_CORE_STATE_L"),
        (0x0017, "IDATA_I_CORE_STATE_H"),
        (0x0018, "IDATA_I_WORK_18"),
        (0x0019, "IDATA_I_WORK_19"),
        (0x0021, "IDATA_I_LOG_INDEX"),
        (0x0022, "IDATA_I_WORK_22"),
        (0x0023, "IDATA_I_WORK_23"),
        (0x002D, "G_STATE_WORK_002D"),
        (0x0038, "IDATA_I_WORK_38"),
        (0x0039, "IDATA_I_WORK_39"),
        (0x003A, "IDATA_I_WORK_3A"),
        (0x003B, "IDATA_I_WORK_3B"),
        (0x003C, "IDATA_I_WORK_3C"),
        (0x003D, "IDATA_I_WORK_3D"),
        (0x003E, "IDATA_I_WORK_3E"),
        (0x003F, "IDATA_I_WORK_3F"),
        (0x0040, "IDATA_I_WORK_40"),
        (0x0041, "IDATA_I_WORK_41"),
        (0x0042, "IDATA_I_WORK_42"),
        (0x0043, "IDATA_I_WORK_43"),
        (0x0044, "IDATA_I_WORK_44"),
        (0x0045, "IDATA_I_WORK_45"),
        (0x0046, "IDATA_I_WORK_46"),
        (0x0047, "IDATA_I_WORK_47"),
        (0x004D, "IDATA_I_FLASH_STATE_4D"),
        (0x0051, "G_ENDPOINT_STATE_0051"),
        (0x0052, "G_SYS_FLAGS_0052"),
        (0x0053, "G_USB_SETUP_RESULT"),
        (0x0054, "G_BUFFER_LENGTH_HIGH"),
        (0x0055, "G_NVME_QUEUE_READY"),
        (0x0056, "G_USB_ADDR_HI_0056"),
        (0x0057, "G_USB_ADDR_LO_0057"),
        (0x0058, "IDATA_I_WORK_58"),
        (0x0059, "IDATA_I_WORK_59"),
        (0x005A, "IDATA_I_WORK_5A"),
        (0x0061, "IDATA_I_WORK_61"),
        (0x0062, "IDATA_I_WORK_62"),
        (0x0063, "IDATA_I_WORK_63"),
        (0x0064, "IDATA_I_WORK_64"),
        (0x0065, "IDATA_I_WORK_65"),
        (0x006A, "IDATA_I_STATE_6A"),
        (0x006B, "IDATA_I_TRANSFER_6B"),
        (0x006C, "IDATA_I_TRANSFER_6C"),
        (0x006D, "IDATA_I_TRANSFER_6D"),
        (0x006E, "IDATA_I_TRANSFER_6E"),
        (0x006F, "IDATA_I_BUF_FLOW_CTRL"),
        (0x0070, "IDATA_I_BUF_THRESH_LO"),
        (0x0071, "IDATA_I_BUF_THRESH_HI"),
        (0x0072, "IDATA_I_BUF_CTRL_GLOBAL"),
        (0x009F, "G_USB_WORK_009F"),
        (0x00C2, "G_INIT_STATE_00C2"),
        (0x00E5, "G_INIT_STATE_00E5"),
        (0x0108, "G_USB_INIT_STATE_0108"),
        (0x012B, "G_WORK_012B"),
        (0x014E, "G_USB_INDEX_COUNTER"),
        (0x0171, "G_SCSI_CTRL"),
        (0x01B4, "G_USB_WORK_01B4"),
        (0x01B6, "G_USB_WORK_01B6"),
        (0x0203, "G_DMA_MODE_SELECT"),
        (0x020D, "G_DMA_PARAM1"),
        (0x020E, "G_DMA_PARAM2"),
        (0x0213, "G_FLASH_READ_TRIGGER"),
        (0x0214, "G_DMA_STATE_0214"),
        (0x0216, "G_DMA_WORK_0216"),
        (0x0217, "G_DMA_OFFSET"),
        (0x0218, "G_BUF_ADDR_HI"),
        (0x0219, "G_BUF_ADDR_LO"),
        (0x021A, "G_BUF_BASE_HI"),
        (0x021B, "G_BUF_BASE_LO"),
        (0x023F, "G_BANK1_STATE_023F"),
        (0x044B, "G_LOG_COUNTER_044B"),
        (0x044C, "G_LOG_ACTIVE_044C"),
        (0x044D, "G_LOG_INIT_044D"),
        (0x045E, "G_REG_WAIT_BIT"),
        (0x0460, "G_WORK_0460"),
        (0x0464, "G_SYS_STATUS_PRIMARY"),
        (0x0465, "G_SYS_STATUS_SECONDARY"),
        (0x0466, "G_SYSTEM_CONFIG"),
        (0x0467, "G_SYSTEM_STATE"),
        (0x0468, "G_DATA_PORT"),
        (0x0469, "G_INT_STATUS"),
        (0x0470, "G_SCSI_CMD_PARAM_0470"),
        (0x0472, "G_DMA_LOAD_PARAM1"),
        (0x0473, "G_DMA_LOAD_PARAM2"),
        (0x0474, "G_STATE_HELPER_41"),
        (0x0475, "G_STATE_HELPER_42"),
        (0x0476, "G_XFER_DIV_0476"),
        (0x0517, "G_EP_INIT_0517"),
        (0x053A, "G_NVME_PARAM_053A"),
        (0x053B, "G_NVME_STATE_053B"),
        (0x053D, "G_SCSI_CMD_TYPE"),
        (0x053E, "G_SCSI_TRANSFER_FLAG"),
        (0x053F, "G_SCSI_BUF_LEN_0"),
        (0x0540, "G_SCSI_BUF_LEN_1"),
        (0x0541, "G_SCSI_BUF_LEN_2"),
        (0x0542, "G_SCSI_BUF_LEN_3"),
        (0x0543, "G_SCSI_LBA_0"),
        (0x0544, "G_SCSI_LBA_1"),
        (0x0545, "G_SCSI_LBA_2"),
        (0x0546, "G_SCSI_LBA_3"),
        (0x0547, "G_SCSI_DEVICE_IDX"),
        (0x054B, "G_EP_CONFIG_BASE"),
        (0x054E, "G_EP_CONFIG_ARRAY"),
        (0x054F, "G_SCSI_MODE_FLAG"),
        (0x0552, "G_SCSI_STATUS_FLAG"),
        (0x0564, "G_EP_QUEUE_CTRL"),
        (0x0565, "G_EP_QUEUE_STATUS"),
        (0x0566, "G_EP_QUEUE_PARAM"),
        (0x0567, "G_EP_QUEUE_IDATA"),
        (0x0568, "G_BUF_OFFSET_HI"),
        (0x0569, "G_BUF_OFFSET_LO"),
        (0x056A, "G_EP_QUEUE_IDATA2"),
        (0x056B, "G_EP_QUEUE_IDATA3"),
        (0x0574, "G_LOG_PROCESS_STATE"),
        (0x0575, "G_LOG_ENTRY_VALUE"),
        (0x0578, "G_DMA_ENDPOINT_0578"),
        (0x057A, "G_EP_LOOKUP_TABLE"),
        (0x05A6, "G_PCIE_TXN_COUNT_LO"),
        (0x05A7, "G_PCIE_TXN_COUNT_HI"),
        (0x05A8, "G_EP_CONFIG_05A8"),
        (0x05AC, "G_DMA_WORK_05AC"),
        (0x05AD, "G_DMA_WORK_05AD"),
        (0x05AE, "G_PCIE_DIRECTION"),
        (0x05AF, "G_PCIE_ADDR_0"),
        (0x05B0, "G_PCIE_ADDR_1"),
        (0x05B1, "G_PCIE_ADDR_2"),
        (0x05B2, "G_PCIE_ADDR_3"),
        (0x05F8, "G_EP_CONFIG_05F8"),
        (0x06CB, "G_SCSI_STATUS_06CB"),
        (0x06E5, "G_MAX_LOG_ENTRIES"),
        (0x06E6, "G_STATE_FLAG_06E6"),
        (0x06E7, "G_WORK_06E7"),
        (0x06E8, "G_WORK_06E8"),
        (0x06EA, "G_ERROR_CODE_06EA"),
        (0x06EB, "G_WORK_06EB"),
        (0x06EC, "G_MISC_FLAG_06EC"),
        (0x0750, "G_VENDOR_ACTIVE_0750"),
        (0x0765, "G_VENDOR_STATE_0765"),
        (0x0775, "G_VENDOR_STATE_0775"),
        (0x07B7, "G_CMD_SLOT_INDEX"),
        (0x07B8, "G_FLASH_CMD_FLAG"),
        (0x07B9, "G_VENDOR_CTRL_07B9"),
        (0x07BB, "G_CMD_PENDING_07BB"),
        (0x07BC, "G_FLASH_CMD_TYPE"),
        (0x07BD, "G_FLASH_OP_COUNTER"),
        (0x07BF, "G_CMD_ADDR_HI"),
        (0x07C0, "G_CMD_ADDR_LO"),
        (0x07C1, "G_CMD_SLOT_C1"),
        (0x07C2, "G_CMD_WORK_C2"),
        (0x07C3, "G_CMD_STATE"),
        (0x07C4, "G_CMD_STATUS"),
        (0x07C5, "G_CMD_WORK_C5"),
        (0x07C7, "G_CMD_WORK_C7"),
        (0x07CA, "G_CMD_MODE"),
        (0x07CC, "G_VENDOR_MODE_07CC"),
        (0x07CF, "G_VENDOR_MODE_07CF"),
        (0x07D3, "G_CMD_PARAM_0"),
        (0x07D4, "G_CMD_PARAM_1"),
        (0x07D5, "G_CMD_PARAM_2"),
        (0x07DA, "G_CMD_LBA_0"),
        (0x07DB, "G_CMD_LBA_1"),
        (0x07DC, "G_CMD_LBA_2"),
        (0x07DD, "G_CMD_LBA_3"),
        (0x07DE, "G_CMD_FLAG_07DE"),
        (0x07DF, "G_PCIE_COMPLETE_07DF"),
        (0x07E3, "G_CMD_WORK_E3"),
        (0x07E4, "G_SYS_FLAGS_BASE"),
        (0x07E5, "G_TRANSFER_ACTIVE"),
        (0x07E8, "G_SYS_FLAGS_07E8"),
        (0x07E9, "G_TLP_STATE_07E9"),
        (0x07EA, "G_XFER_FLAG_07EA"),
        (0x07EB, "G_SYS_FLAGS_07EB"),
        (0x07EC, "G_SYS_FLAGS_07EC"),
        (0x07ED, "G_SYS_FLAGS_07ED"),
        (0x07EE, "G_SYS_FLAGS_07EE"),
        (0x07EF, "G_SYS_FLAGS_07EF"),
        (0x07F0, "G_SYS_FLAGS_07F0"),
        (0x07F1, "G_SYS_FLAGS_07F1"),
        (0x07F2, "G_SYS_FLAGS_07F2"),
        (0x07F3, "G_SYS_FLAGS_07F3"),
        (0x07F4, "G_SYS_FLAGS_07F4"),
        (0x07F5, "G_SYS_FLAGS_07F5"),
        (0x07F6, "G_SYS_FLAGS_07F6"),
        (0x07F7, "G_SYS_FLAGS_07F7"),
        (0x07FF, "G_CMD_DEBUG_FF"),
        (0x0804, "G_VENDOR_CMD_BUF_0804"),
        (0x0805, "G_VENDOR_CMD_BUF_0805"),
        (0x0810, "G_VENDOR_CDB_BASE"),
        (0x0816, "G_VENDOR_RESP_BUF"),
        (0x081A, "G_VENDOR_STATUS_081A"),
        (0x081B, "G_VENDOR_STATUS_081B"),
        (0x086C, "G_FLASH_CFG_086C"),
        (0x086D, "G_FLASH_CFG_086D"),
        (0x086E, "G_FLASH_CFG_086E"),
        (0x086F, "G_FLASH_CFG_086F"),
        (0x0870, "G_FLASH_CFG_0870"),
        (0x0871, "G_FLASH_CFG_0871"),
        (0x097A, "G_EVENT_INIT_097A"),
        (0x098E, "G_LOOP_CHECK_098E"),
        (0x0991, "G_LOOP_STATE_0991"),
        (0x09EF, "G_EVENT_CHECK_09EF"),
        (0x09F4, "G_FLASH_MODE_1"),
        (0x09F5, "G_FLASH_MODE_2"),
        (0x09F6, "G_FLASH_MODE_3"),
        (0x09F7, "G_FLASH_MODE_4"),
        (0x09F8, "G_FLASH_MODE_5"),
        (0x09F9, "G_EVENT_FLAGS"),
        (0x09FA, "G_EVENT_CTRL_09FA"),
        (0x09FB, "G_FLASH_STATUS_09FB"),
        (0x0A41, "G_FLASH_CFG_0A41"),
        (0x0A42, "G_FLASH_CFG_0A42"),
        (0x0A43, "G_FLASH_CFG_0A43"),
        (0x0A44, "G_FLASH_CFG_0A44"),
        (0x0A45, "G_FLASH_CFG_0A45"),
        (0x0A52, "G_PCIE_ADAPTER_CFG_LO"),
        (0x0A53, "G_PCIE_ADAPTER_CFG_HI"),
        (0x0A54, "G_PCIE_ADAPTER_MODE"),
        (0x0A55, "G_PCIE_ADAPTER_AUX"),
        (0x0A56, "G_FLASH_CONFIG_VALID"),
        (0x0A57, "G_CMD_CTRL_PARAM"),
        (0x0A58, "G_CMD_TIMEOUT_PARAM"),
        (0x0A59, "G_LOOP_STATE"),
        (0x0A5A, "G_LOOP_STATE_0A5A"),
        (0x0A5B, "G_EP_CFG_FLAG_0A5B"),
        (0x0A5C, "G_EP_CFG_0A5C"),
        (0x0A5D, "G_EP_CFG_0A5D"),
        (0x0A5E, "G_EP_CFG_0A5E"),
        (0x0A5F, "G_EP_CFG_0A5F"),
        (0x0A60, "G_EP_CFG_0A60"),
        (0x0A61, "G_POWER_STATE_MAX_0A61"),
        (0x0A62, "G_POWER_STATE_IDX_0A62"),
        (0x0A7B, "G_EP_DISPATCH_VAL1"),
        (0x0A7C, "G_EP_DISPATCH_VAL2"),
        (0x0A7D, "G_EP_DISPATCH_VAL3"),
        (0x0A7E, "G_EP_DISPATCH_VAL4"),
        (0x0A83, "G_ACTION_CODE_0A83"),
        (0x0A84, "G_ACTION_PARAM_0A84"),
        (0x0A85, "G_STATE_WORK_0A85"),
        (0x0A86, "G_STATE_WORK_0A86"),
        (0x0A8D, "G_DMA_PARAM_0A8D"),
        (0x0A8E, "G_DMA_MODE_0A8E"),
        (0x0A9D, "G_LANE_STATE_0A9D"),
        (0x0A9E, "G_PCIE_LANE_STATE_0A9E"),
        (0x0AA1, "G_LOG_PROCESSED_INDEX"),
        (0x0AA2, "G_STATE_PARAM_0AA2"),
        (0x0AA3, "G_STATE_COUNTER_HI"),
        (0x0AA4, "G_STATE_COUNTER_LO"),
        (0x0AA5, "G_STATE_COUNTER_0AA5"),
        (0x0AA6, "G_BUFFER_STATE_0AA6"),
        (0x0AA7, "G_BUFFER_STATE_0AA7"),
        (0x0AA8, "G_TLP_COUNT_HI"),
        (0x0AA9, "G_TLP_COUNT_LO"),
        (0x0AAA, "G_TLP_STATUS"),
        (0x0AAB, "G_STATE_HELPER_0AAB"),
        (0x0AAC, "G_STATE_COUNTER_0AAC"),
        (0x0AAD, "G_FLASH_ADDR_0"),
        (0x0AAE, "G_FLASH_ADDR_1"),
        (0x0AAF, "G_FLASH_ADDR_2"),
        (0x0AB0, "G_FLASH_ADDR_3"),
        (0x0AB1, "G_FLASH_LEN_LO"),
        (0x0AB2, "G_FLASH_LEN_HI"),
        (0x0AB5, "G_VENDOR_DATA_0AB5"),
        (0x0AB6, "G_STATE_0AB6"),
        (0x0AB7, "G_VENDOR_DATA_0AB7"),
        (0x0ACB, "G_TLP_MASK_0ACB"),
        (0x0ACC, "G_TLP_BLOCK_SIZE_0ACC"),
        (0x0ACD, "G_USB_DESC_FLAG_0ACD"),
        (0x0ACE, "G_USB_DESC_MODE_0ACE"),
        (0x0ACF, "G_TLP_STATE_0ACF"),
        (0x0AD0, "G_TLP_CMD_STATE_0AD0"),
        (0x0AD1, "G_LINK_STATE_0AD1"),
        (0x0AD2, "G_LINK_STATE_0AD2"),
        (0x0AD3, "G_TLP_MODE_0AD3"),
        (0x0AD5, "G_TLP_ADDR_OFFSET_HI"),
        (0x0AD6, "G_TLP_ADDR_OFFSET_LO"),
        (0x0AD7, "G_USB_DESC_STATE_0AD7"),
        (0x0AD8, "G_TLP_TIMEOUT_HI"),
        (0x0AD9, "G_TLP_TIMEOUT_LO"),
        (0x0ADA, "G_TLP_TRANSFER_HI"),
        (0x0ADB, "G_TLP_TRANSFER_LO"),
        (0x0ADC, "G_TLP_COMPUTED_HI"),
        (0x0ADD, "G_TLP_COMPUTED_LO"),
        (0x0ADE, "G_USB_DESC_INDEX_0ADE"),
        (0x0ADF, "G_TLP_LIMIT_LO"),
        (0x0AE0, "G_TLP_BASE_HI"),
        (0x0AE1, "G_TLP_BASE_LO"),
        (0x0AE2, "G_SYSTEM_STATE_0AE2"),
        (0x0AE3, "G_STATE_FLAG_0AE3"),
        (0x0AE4, "G_PHY_LANE_CFG_0AE4"),
        (0x0AE5, "G_TLP_INIT_FLAG_0AE5"),
        (0x0AE6, "G_LINK_SPEED_MODE_0AE6"),
        (0x0AE7, "G_LINK_CFG_BIT_0AE7"),
        (0x0AE8, "G_STATE_0AE8"),
        (0x0AE9, "G_STATE_0AE9"),
        (0x0AEA, "G_FLASH_CFG_0AEA"),
        (0x0AEB, "G_LINK_CFG_0AEB"),
        (0x0AEC, "G_PHY_CFG_0AEC"),
        (0x0AED, "G_PHY_CFG_0AED"),
        (0x0AEE, "G_STATE_CHECK_0AEE"),
        (0x0AEF, "G_LINK_CFG_0AEF"),
        (0x0AF0, "G_FLASH_CFG_0AF0"),
        (0x0AF1, "G_STATE_FLAG_0AF1"),
        (0x0AF2, "G_TRANSFER_FLAG_0AF2"),
        (0x0AF3, "G_XFER_STATE_0AF3"),
        (0x0AF4, "G_XFER_LUN_0AF4"),
        (0x0AF5, "G_EP_DISPATCH_OFFSET"),
        (0x0AF6, "G_XFER_STATE_0AF6"),
        (0x0AF7, "G_XFER_CTRL_0AF7"),
        (0x0AF8, "G_POWER_INIT_FLAG"),
        (0x0AF9, "G_XFER_MODE_0AF9"),
        (0x0AFA, "G_TRANSFER_PARAMS_HI"),
        (0x0AFB, "G_TRANSFER_PARAMS_LO"),
        (0x0AFC, "G_XFER_COUNT_LO"),
        (0x0AFD, "G_XFER_COUNT_HI"),
        (0x0AFE, "G_XFER_RETRY_CNT"),
        (0x0B00, "G_USB_PARAM_0B00"),
        (0x0B01, "G_USB_INIT_0B01"),
        (0x0B12, "G_PCIE_WORK_0B12"),
        (0x0B13, "G_PCIE_STATUS_0B13"),
        (0x0B14, "G_PCIE_STATUS_0B14"),
        (0x0B15, "G_PCIE_STATUS_0B15"),
        (0x0B16, "G_PCIE_STATUS_0B16"),
        (0x0B17, "G_PCIE_STATUS_0B17"),
        (0x0B18, "G_PCIE_STATUS_0B18"),
        (0x0B19, "G_PCIE_STATUS_0B19"),
        (0x0B1A, "G_PCIE_STATUS_0B1A"),
        (0x0B1B, "G_STATE_0B1B"),
        (0x0B1C, "G_PCIE_STATUS_0B1C"),
        (0x0B1D, "G_DMA_WORK_0B1D"),
        (0x0B1E, "G_DMA_WORK_0B1E"),
        (0x0B1F, "G_DMA_WORK_0B1F"),
        (0x0B20, "G_DMA_WORK_0B20"),
        (0x0B21, "G_TLP_PENDING_0B21"),
        (0x0B24, "G_DMA_WORK_0B24"),
        (0x0B25, "G_DMA_WORK_0B25"),
        (0x0B2E, "G_USB_TRANSFER_FLAG"),
        (0x0B2F, "G_INTERFACE_READY_0B2F"),
        (0x0B34, "G_PCIE_WORK_0B34"),
        (0x0B35, "G_PCIE_STATUS_0B35"),
        (0x0B36, "G_PCIE_STATUS_0B36"),
        (0x0B37, "G_PCIE_STATUS_0B37"),
        (0x0B39, "G_STATE_0B39"),
        (0x0B3B, "G_TRANSFER_BUSY_0B3B"),
        (0x0B3C, "G_STATE_CTRL_0B3C"),
        (0x0B3D, "G_STATE_WORK_0B3D"),
        (0x0B3E, "G_STATE_CTRL_0B3E"),
        (0x0B3F, "G_STATE_CTRL_0B3F"),
        (0x0B40, "G_TIMER_INIT_0B40"),
        (0x0B41, "G_USB_STATE_0B41"),
        (0x0B44, "G_PCIE_CTRL_SAVE_0B44"),
        (0x7000, "G_FLASH_BUF_BASE"),
        (0x7004, "G_FLASH_BUF_7004"),
        (0x702C, "G_FLASH_BUF_702C"),
        (0x7059, "G_FLASH_BUF_7059"),
        (0x705A, "G_FLASH_BUF_705A"),
        (0x705C, "G_FLASH_BUF_705C"),
        (0x705D, "G_FLASH_BUF_705D"),
        (0x705E, "G_FLASH_BUF_705E"),
        (0x705F, "G_FLASH_BUF_705F"),
        (0x7064, "G_FLASH_BUF_7064"),
        (0x7074, "G_FLASH_BUF_7074"),
        (0x7075, "G_FLASH_BUF_7075"),
        (0x7076, "G_FLASH_BUF_7076"),
        (0x7077, "G_FLASH_BUF_7077"),
        (0x7078, "G_FLASH_BUF_7078"),
        (0x7079, "G_FLASH_BUF_7079"),
        (0x707A, "G_FLASH_BUF_707A"),
        (0x707B, "G_FLASH_BUF_707B"),
        (0x707C, "G_FLASH_BUF_707C"),
        (0x707D, "G_FLASH_BUF_707D"),
        (0x707E, "G_FLASH_BUF_707E"),
        (0x707F, "G_FLASH_BUF_707F"),
    ]

    count = 0
    for addr_int, name in globals_list:
        try:
            # Try EXTMEM space first
            addr = toAddr("EXTMEM:{:04X}".format(addr_int))
            if create_label(addr, name):
                count += 1
        except:
            try:
                # Fall back to direct address
                addr = toAddr(addr_int)
                if create_label(addr, name):
                    count += 1
            except Exception as e:
                print("Error adding global {} at 0x{:04X}: {}".format(name, addr_int, e))

    return count

def run():
    """Main entry point"""
    print("=" * 70)
    print("AS2464 USB4/NVMe Firmware Symbol Import Script")
    print("Auto-generated from C reimplementation project")
    print("")
    print("This script handles both CODE_BANK0 and CODE_BANK1 sections:")
    print("  CODE_BANK0: 0x0000-0xFFFF  (always accessible)")
    print("  CODE_BANK1: 0x10000-0x17FFF (file offsets, mapped to 0x8000-0xFFFF)")
    print("=" * 70)

    print("\nAdding Bank 0 function names (0x0000-0xFFFF)...")
    func0_count = add_bank0_functions()
    print("Added {} Bank 0 functions".format(func0_count))

    print("\nAdding Bank 1 function names (file 0x10000-0x17FFF)...")
    func1_count = add_bank1_functions()
    print("Added {} Bank 1 functions".format(func1_count))

    print("\nAdding register labels (EXTMEM)...")
    reg_count = add_registers()
    print("Added {} registers".format(reg_count))

    print("\nAdding global variable labels (EXTMEM)...")
    glob_count = add_globals()
    print("Added {} globals".format(glob_count))

    print("\n" + "=" * 70)
    print("Import complete!")
    print("Total symbols added: {}".format(func0_count + func1_count + reg_count + glob_count))
    print("  Bank 0 functions: {}".format(func0_count))
    print("  Bank 1 functions: {}".format(func1_count))
    print("  Registers: {}".format(reg_count))
    print("  Globals: {}".format(glob_count))
    print("=" * 70)

# Run the script
run()
